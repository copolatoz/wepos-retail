/**
 * Filename: audit_closing.closingPurchasing.js
 * Generated 2018-09-04 at 08:57:41 PM
 */
Ext.define('ExtApp.modules.audit_closing.model.model_closingPurchasing',{extend:'Ext.data.Model',alias:'model_closingPurchasing',fields:[{name:'id',type:'int'},{name:'tanggal',type:'string'},{name:'generate_status',type:'int'},{name:'generate_status_text',type:'string'},{name:'closing_status',type:'int'},{name:'closing_status_text',type:'string'}],proxy:{type:'ajax',url:appUrl+'audit_closing/closingPurchasing/gridData',extraParams:{},actionMethods:{read:'POST'},reader:{type:'json',root:'data',idProperty:'id',totalProperty:'totalCount'}}});Ext.define('ExtApp.modules.audit_closing.model.model_closingPurchasingDetail',{extend:'Ext.data.Model',alias:'model_closingPurchasingDetail',fields:[{name:'id',type:'string'},{name:'keterangan',type:'string'},{name:'keterangan_val',type:'string'},{name:'total',type:'string'}],proxy:{type:'ajax',url:appUrl+'audit_closing/closingPurchasing/gridDataDetail',extraParams:{},actionMethods:{read:'POST'},reader:{type:'json',root:'data',idProperty:'id',totalProperty:'totalCount'}}});Ext.define('ExtApp.modules.audit_closing.store.store_closingPurchasing',{extend:'Ext.data.Store',model:'ExtApp.modules.audit_closing.model.model_closingPurchasing',autoLoad:false,remoteSort:true});Ext.define('ExtApp.modules.audit_closing.store.store_closingPurchasingDetail',{extend:'Ext.data.Store',model:'ExtApp.modules.audit_closing.model.model_closingPurchasingDetail',autoLoad:false,remoteSort:true});Ext.define("ExtApp.modules.audit_closing.view.closingPurchasing",{openWindow:function(me){var theApp=me.app;var desktop=theApp.getDesktop();var store_closingPurchasing_grid=theApp.getStore('store_closingPurchasing_grid',false);if(store_closingPurchasing_grid==false){store_closingPurchasing_grid=theApp.copyStore('audit_closing','store_closingPurchasing','store_closingPurchasing_grid');}
store_closingPurchasing_grid.proxy.extraParams.limit=999999;var store_closingPurchasingDetail_grid=theApp.getStore('store_closingPurchasingDetail_grid',false);if(store_closingPurchasingDetail_grid==false){store_closingPurchasingDetail_grid=theApp.copyStore('audit_closing','store_closingPurchasingDetail','store_closingPurchasingDetail_grid');}
store_closingPurchasingDetail_grid.proxy.extraParams.limit=999999;store_closingPurchasingDetail_grid.proxy.extraParams.closing_date='';var helperGrid=theApp.getHelper('Grid');var phpJs=theApp.getHelper('phpJs');var selModel_closingPurchasing=Ext.create('Ext.selection.CheckboxModel',{listeners:{selectionchange:function(sm,selections){Ext.getCmp('generateButton_closingPurchasing').setDisabled(selections.length==0);Ext.getCmp('closingButton_closingPurchasing').setDisabled(selections.length==0);Ext.getCmp('openButton_closingPurchasing').setDisabled(selections.length==0);}}});return desktop.createWindow({id:me.id,title:'Closing Purchasing',width:850,height:500,iconCls:'icon-grid',animCollapse:false,constrainHeader:true,resizable:true,maximized:false,border:false,border:0,layout:{type:'fit'},items:[{xtype:'panel',border:0,layout:{type:'border'},items:[{title:'Closing Date',xtype:'gridpanel',flex:2,margins:'0 5 0 0',region:'west',store:store_closingPurchasing_grid,id:'grid_closingPurchasing',scroll:true,selModel:selModel_closingPurchasing,columns:[{xtype:'gridcolumn',dataIndex:'id',text:'ID',hidden:true,hideable:false},{xtype:'gridcolumn',dataIndex:'generate_status',text:'generate_status',hidden:true,hideable:false},{xtype:'gridcolumn',dataIndex:'closing_status',text:'closing_status',hidden:true,hideable:false},{xtype:'gridcolumn',dataIndex:'tanggal',text:'Date',width:100,sortable:false},{xtype:'gridcolumn',dataIndex:'generate_status_text',text:'Generate',width:100,align:'center',sortable:false},{xtype:'gridcolumn',dataIndex:'closing_status_text',text:'Closing',width:100,align:'center',sortable:false}],viewConfig:{stripeRows:true,forceFit:true},listeners:{itemdblclick:function(view,rec,item,index,eventObj){var getSelection=Ext.getCmp('grid_closingPurchasing').getSelectionModel().selected;if(getSelection.length>0){store_closingPurchasingDetail_grid.proxy.extraParams.closing_date=rec.data.tanggal;store_closingPurchasingDetail_grid.load();}}},},{title:'Closing Purchasing Detail',xtype:'gridpanel',flex:3,margins:'0 0 0 0',region:'center',store:store_closingPurchasingDetail_grid,id:'grid_closingPurchasingDetail',scroll:true,columns:[{xtype:'gridcolumn',dataIndex:'keterangan',text:'Description',width:300,sortable:false},{xtype:'gridcolumn',dataIndex:'total',text:'Value',width:170,sortable:false}],viewConfig:{stripeRows:true,forceFit:true},listeners:{itemdblclick:function(view,rec,item,index,eventObj){}},}],dockedItems:[{xtype:'toolbar',dock:'top',items:[{xtype:'datefield',id:'dateFrom_closingPurchasing',fieldLabel:'Date From',name:'date_from',labelSeparator:'',format:'d-m-Y',altFormats:'Y-m-d|d-m-Y|dmY|Ymd',margin:'5 0 0 0',labelWidth:65,width:170,value:phpJs.date('01-m-Y'),allowBlank:false},{xtype:'datefield',id:'dateTill_closingPurchasing',fieldLabel:' To ',name:'date_till',labelSeparator:'',format:'d-m-Y',altFormats:'Y-m-d|d-m-Y|dmY|Ymd',margin:'5 0 0 10',labelWidth:20,width:125,value:phpJs.date('t-m-Y'),allowBlank:false},'',{xtype:'button',text:'Search',id:'searchButton_closingPurchasing',tooltip:'Search',iconCls:'btn-search',handler:function(){me.search_closingPurchasing();}},{xtype:'button',text:'Reset',id:'resetButton_closingPurchasing',tooltip:'Reset',iconCls:'btn-reset',handler:function(){Ext.getCmp('dateFrom_closingPurchasing').setValue(phpJs.date('01-m-Y'));Ext.getCmp('dateTill_closingPurchasing').setValue(phpJs.date('t-m-Y'));me.search_closingPurchasing();}},'->',{text:'Generate',id:'generateButton_closingPurchasing',tooltip:'Generate Data Purchasing',iconCls:'btn-refresh',listeners:{click:function(){var getSelection=Ext.getCmp('grid_closingPurchasing').getSelectionModel().selected;if(getSelection.length>0){me.closing_data=getSelection.items[0].data;me.generateConfirm_closingPurchasing();}else{ExtApp.Msg.info('Please Select Closing Purchasing!');}}}},{text:'Closing',id:'closingButton_closingPurchasing',tooltip:'Closing Data Purchasing',disabled:true,iconCls:'btn-lock',listeners:{click:function(){var getSelection=Ext.getCmp('grid_closingPurchasing').getSelectionModel().selected;if(getSelection.length>0){me.closing_data=getSelection.items[0].data;me.closingConfirm_closingPurchasing();}else{ExtApp.Msg.info('Please Select Closing Purchasing!');}}}},{text:'Open',id:'openButton_closingPurchasing',tooltip:'Open Data Purchasing',iconCls:'btn-lock-open',disabled:true,listeners:{click:function(){var getSelection=Ext.getCmp('grid_closingPurchasing').getSelectionModel().selected;if(getSelection.length>0){me.closing_data=getSelection.items[0].data;me.openConfirm_closingPurchasing();}else{ExtApp.Msg.info('Please Select Closing Purchasing!');}}}}]}]}],listeners:{boxready:function(){me.search_closingPurchasing();},show:function(){}}});}});