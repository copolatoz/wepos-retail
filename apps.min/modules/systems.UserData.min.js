/**
 * Filename: systems.UserData.js
 * Generated 2018-09-04 at 08:49:41 PM
 */
Ext.define('ExtApp.modules.systems.model.model_UserData',{extend:'Ext.data.Model',alias:'model_UserData',fields:[{name:'id',type:'int'},{name:'user_username',type:'string'},{name:'user_pin',type:'string'},{name:'client_id',type:'int'},{name:'client_name',type:'string'},{name:'client_structure_id',type:'int'},{name:'client_structure_name',type:'string'},{name:'role_id',type:'int'},{name:'role_name',type:'string'},{name:'user_fullname',type:'string'},{name:'user_firstname',type:'string'},{name:'user_lastname',type:'string'},{name:'user_email',type:'string'},{name:'user_phone',type:'string'},{name:'user_mobile',type:'string'},{name:'user_address',type:'string'},{name:'avatar',type:'string'},{name:'is_active',type:'int'},{name:'is_active_text',type:'string'},{name:'window_mode',type:'string'}],proxy:{type:'ajax',url:appUrl+'systems/UserData/gridData',extraParams:{},actionMethods:{read:'POST'},reader:{type:'json',root:'data',idProperty:'id',totalProperty:'totalCount'}}});Ext.define('ExtApp.modules.systems.model.model_DataStructure',{extend:'Ext.data.Model',alias:'model_DataStructure',fields:[{name:'id',type:'int'},{name:'client_structure_name',type:'string'},{name:'client_structure_nama_show',type:'string'},{name:'client_structure_parent',type:'int'},{name:'client_structure_parent_name',type:'string'},{name:'client_unit_id',type:'int'},{name:'client_unit_name',type:'string'},{name:'role_id',type:'int'},{name:'role_name',type:'string'},{name:'is_active',type:'int'},{name:'is_active_text',type:'string'},{name:'is_child',type:'int'},{name:'client_structure_notes',type:'string'},{name:'client_structure_order',type:'int'},{name:'updated',type:'date'},{name:'updatedby',type:'string'}]});Ext.define('ExtApp.modules.systems.store.store_UserData',{extend:'Ext.data.Store',model:'ExtApp.modules.systems.model.model_UserData',autoLoad:false,remoteSort:true});Ext.define('ExtApp.modules.systems.store.store_DataStructure_parent',{extend:'Ext.data.Store',model:'ExtApp.modules.systems.model.model_DataStructure',autoLoad:false,proxy:{type:'ajax',url:appUrl+'systems/DataStructure/gridData',extraParams:{limit:9999,is_dropdown:1},actionMethods:{read:'POST'},reader:{type:'json',root:'data',idProperty:'id',totalProperty:'totalCount'}}});Ext.define("ExtApp.modules.systems.view.UserData",{openWindow:function(me){var theApp=me.app;var desktop=theApp.getDesktop();var store_UserData_UserData=theApp.getStore('store_UserData_UserData',false);if(store_UserData_UserData==false){store_UserData_UserData=theApp.copyStore('systems','store_UserData','store_UserData_UserData');}
store_UserData_UserData.proxy.extraParams.limit=25;store_UserData_UserData.proxy.extraParams.show_all_text=0;store_UserData_UserData.proxy.extraParams.show_choose_text=0;store_UserData_UserData.proxy.extraParams.is_dropdown=0;store_UserData_UserData.proxy.extraParams.keywords='';var helperGrid=theApp.getHelper('Grid');var selModel_UserData=Ext.create('Ext.selection.CheckboxModel',{listeners:{selectionchange:function(sm,selections){Ext.getCmp('grid_UserData').down('#deleteButton_UserData').setDisabled(selections.length==0);}}});me.pagingtb_UserData=helperGrid.paging({ds:store_UserData_UserData,title:'Data User'});return desktop.createWindow({id:me.id,title:'Data User',width:800,height:480,iconCls:'icon-user-data',animCollapse:false,constrainHeader:true,resizable:true,maximized:false,border:0,layout:{type:'fit'},items:[{xtype:'gridpanel',margins:'0 0 0 0',region:'center',store:store_UserData_UserData,id:'grid_UserData',scroll:true,selModel:selModel_UserData,columns:[{xtype:'gridcolumn',dataIndex:'id',text:'ID',hidden:true,hideable:false},{xtype:'gridcolumn',dataIndex:'user_username',text:'Username',width:100},{xtype:'gridcolumn',dataIndex:'user_fullname',text:'Full Name',width:120},{xtype:'gridcolumn',dataIndex:'role_name',text:'Roles',width:120},{xtype:'gridcolumn',dataIndex:'client_structure_name',text:'Structure',width:120},{xtype:'gridcolumn',dataIndex:'client_name',text:'Client',width:200,hidden:true,hideable:false},{xtype:'gridcolumn',dataIndex:'user_email',text:'Email',width:130},{xtype:'gridcolumn',dataIndex:'user_phone',text:'Telp',width:130},{xtype:'gridcolumn',dataIndex:'user_mobile',text:'HP',width:130},{xtype:'gridcolumn',dataIndex:'is_active_text',text:'Status',width:100}],viewConfig:{stripeRows:true,forceFit:true},listeners:{itemdblclick:function(view,rec,item,index,eventObj){var getSelection=Ext.getCmp('grid_UserData').getSelectionModel().selected;if(getSelection.length>0){me.formType='edit';me.edit_data=rec.data;me.createWindow(me,'add_UserData');}}},bbar:me.pagingtb_UserData,dockedItems:[{xtype:'toolbar',dock:'top',items:[{xtype:'textfield',name:'keywords',id:'keywords_UserData',width:200,labelSeparator:'',emptyText:'Keywords: Full Name',anchor:'100%',listeners:{specialkey:function(field,e){if(e.getKey()==e.ENTER){me.search_UserData();}}}},{xtype:'button',text:'Search',itemId:'btnFilterSearch_UserData',tooltip:'Search',iconCls:'btn-search',handler:function(){me.search_UserData();}},{xtype:'button',text:'Reset',itemId:'btnResetFilterSearch_UserData',tooltip:'Reset',iconCls:'btn-reset',handler:function(){me.search_UserData(true);}},'->',{text:'Add',itemId:'addButton_UserData',tooltip:'Add New User',iconCls:'btn-add',handler:function(){me.formType='add';me.createWindow(me,'add_UserData');}},'-',{text:'Delete',itemId:'deleteButton_UserData',tooltip:'Delete User',iconCls:'btn-delete',disabled:true,handler:function(){var getSelection=Ext.getCmp('grid_UserData').getSelectionModel().selected;if(getSelection.length>0){me.delete_data=getSelection.items[0].data;me.deleteConfirm_UserData();}else{ExtApp.Msg.info('Please Select User!');}}},]}]}],listeners:{boxready:function(){me.search_UserData();}}});},add_UserData:function(me){var theApp=me.app;var desktop=theApp.getDesktop();var Titletext='Add New ';if(me.formType=='edit'){Titletext='Update ';}
var store_DataStructure_parent_UserData=theApp.getStore('store_DataStructure_parent_UserData',false);if(store_DataStructure_parent_UserData==false){store_DataStructure_parent_UserData=theApp.copyStore('systems','store_DataStructure_parent','store_DataStructure_parent_UserData');}
var d=new Date();var curr_time=d.getTime();var required='<span style="color:red;font-weight:bold" data-qtip="Required">*</span>';return desktop.createWindow({id:me.id+'_add_UserData',title:Titletext,width:500,iconCls:'btn-add',animCollapse:false,constrainHeader:true,resizable:false,minimizable:false,maximizable:false,modal:true,border:0,layout:{type:'fit'},items:[{xtype:'form',id:'form_UserData',width:490,border:false,bodyBorder:false,fieldDefaults:{labelWidth:80,msgTarget:'side',autoFitErrors:false},items:{xtype:'tabpanel',minHeight:280,activeTab:0,border:false,defaults:{bodyPadding:'10 20 10 10',layout:'fit'},items:[{title:'Personal Details',layout:'fit',items:[{xtype:'panel',defaultType:'textfield',layout:{type:'anchor'},defaults:{allowBlank:false,anchor:'100%'},border:false,items:[{xtype:'hidden',name:'form_type_UserData',value:me.formType},{xtype:'hidden',name:'id'},{xtype:'hidden',name:'role_id'},{xtype:'hidden',name:'client_structure_id'},{xtype:'combobox',name:'client_structure_combo',margin:'5 0 5 0',emptyText:'- Pilih Structure -',fieldLabel:'Structure',anchor:'100%',store:store_DataStructure_parent_UserData,queryMode:'local',hiddenName:"client_structure_combo",displayField:'client_structure_name',valueField:'id',typeAhead:true,minChars:1,forceSelection:true,allowBlank:false,listConfig:{emptyText:'Tidak ada data Structure',minWidth:350,getInnerTpl:function(){return'{client_structure_nama_show}';}},pageSize:0,listeners:{select:{fn:function(c,r,i){Ext.getCmp('form_UserData').getForm().findField('client_structure_id').setValue(r[0].data.id);Ext.getCmp('form_UserData').getForm().findField('role_id').setValue(r[0].data.role_id);}}}},{xtype:'textfield',name:'user_username',fieldLabel:'Username',anchor:'100%',allowBlank:false},{fieldLabel:'First Name',name:'user_firstname',afterLabelTextTpl:required,value:''},{fieldLabel:'Last Name',afterLabelTextTpl:required,name:'user_lastname',value:''},{fieldLabel:'Email',afterLabelTextTpl:required,name:'user_email',vtype:'email'},{xtype:'checkbox',name:'is_active',fieldLabel:'Status Active',inputValue:'1'}]}]},{title:'Phone Numbers',layout:'fit',items:[{xtype:'panel',defaultType:'textfield',layout:{type:'anchor'},defaults:{anchor:'100%'},border:false,items:[{fieldLabel:'Home',name:'user_phone'},{fieldLabel:'Mobile',name:'user_mobile'}]}]},{title:'Address',layout:'fit',items:[{xtype:'panel',defaultType:'textareafield',layout:{type:'anchor'},defaults:{anchor:'100%'},border:false,items:[{fieldLabel:'Address',name:'user_address'}]}]},{title:'Password',layout:'fit',items:[{xtype:'panel',defaultType:'textfield',layout:{type:'anchor'},defaults:{labelWidth:125,anchor:'100%'},border:false,items:[{fieldLabel:'Old Password',name:'old_pass',inputType:'password'},{fieldLabel:'New Password',name:'new_pass',inputType:'password',itemId:'pass',listeners:{validitychange:function(field){field.next().validate();},blur:function(field){field.next().validate();}}},{fieldLabel:'Confirm Password',name:'pass_confirm',inputType:'password',vtype:'password',initialPassField:'pass'},{xtype:'displayfield',fieldLabel:'User PIN',name:'user_pin'},{xtype:'checkbox',name:'change_pin',fieldLabel:'Change PIN',inputValue:'1'}]}]},{title:'Apps Setting',layout:'fit',items:[{xtype:'panel',defaultType:'textfield',layout:{type:'anchor'},border:false,items:[{xtype:'radiogroup',fieldLabel:'Window Mode',width:300,labelWidth:100,items:[{boxLabel:'Full',name:'window_mode',inputValue:'full',checked:true},{boxLabel:'Lite',name:'window_mode',inputValue:'lite'},]}]}]}]}}],buttons:[{text:'Save',formBind:true,id:'btnSave_UserData',iconCls:'btn-save',handler:function(){me.save_UserData();}},{text:'Cancel',iconCls:'btn-cancel',handler:function(){me.doClose(me.id+'_add_UserData');}}],listeners:{boxready:function(){store_DataStructure_parent_UserData.load();},show:function(){var form=Ext.getCmp('form_UserData').getForm();if(me.formType=='edit'){form.setValues(me.edit_data);form.findField('client_structure_combo').select(me.edit_data.client_structure_id);form.findField('old_pass').show();form.findField('new_pass').allowBlank=true;}else{form.reset();form.findField('is_active').setValue(1);form.findField('old_pass').hide();form.findField('new_pass').allowBlank=false;}}}});}});