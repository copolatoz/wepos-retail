/**
 * Filename: master_pos.masterCustomer.js
 * Generated 2019-03-25 at 10:00:16 PM
 */
Ext.define('ExtApp.modules.master_pos.model.model_masterCustomer',{extend:'Ext.data.Model',alias:'model_masterCustomer',fields:[{name:'id',type:'int'},{name:'customer_code',type:'string'},{name:'customer_name',type:'string'},{name:'customer_contact_person',type:'string'},{name:'customer_address',type:'string'},{name:'customer_phone',type:'string'},{name:'customer_email',type:'string'},{name:'customer_status',type:'string'},{name:'customer_status_text',type:'string'},{name:'keterangan_blacklist',type:'string'},{name:'is_active',type:'int'},{name:'is_active_text',type:'string'},{name:'source_from',type:'string'}],proxy:{type:'ajax',url:appUrl+'master_pos/masterCustomer/gridData',extraParams:{},actionMethods:{read:'POST'},reader:{type:'json',root:'data',idProperty:'id',totalProperty:'totalCount'}}});Ext.define('ExtApp.modules.master_pos.store.store_masterCustomer',{extend:'Ext.data.Store',model:'ExtApp.modules.master_pos.model.model_masterCustomer',autoLoad:false,remoteSort:true});Ext.define('ExtApp.modules.master_pos.store.store_masterStatus',{extend:'Ext.data.Store',fields:['val','name'],data:[{"val":"ok","name":"OK"},{"val":"warning","name":"Warning"},{"val":"blacklist","name":"Blaclist"}],autoLoad:false});Ext.define("ExtApp.modules.master_pos.view.masterCustomer",{openWindow:function(me){var theApp=me.app;var desktop=theApp.getDesktop();var phpJs=me.app.getHelper('phpJs');var add_parameter='_dc='+phpJs.mktime();add_parameter+='&module=master_pos';add_parameter+='&file=masterCustomer';add_parameter+='&action=print_masterCustomer';var url_report='';var store_masterCustomer_masterCustomer=theApp.getStore('store_masterCustomer_masterCustomer',false);if(store_masterCustomer_masterCustomer==false){store_masterCustomer_masterCustomer=theApp.copyStore('master_pos','store_masterCustomer','store_masterCustomer_masterCustomer');}
store_masterCustomer_masterCustomer.proxy.extraParams.limit=25;store_masterCustomer_masterCustomer.proxy.extraParams.is_dropdown=0;store_masterCustomer_masterCustomer.proxy.extraParams.is_active=0;store_masterCustomer_masterCustomer.proxy.extraParams.show_all_text=0;store_masterCustomer_masterCustomer.proxy.extraParams.show_choose_text=0;store_masterCustomer_masterCustomer.proxy.extraParams.keywords='';var helperGrid=theApp.getHelper('Grid');var selModel_masterCustomer=Ext.create('Ext.selection.CheckboxModel',{listeners:{selectionchange:function(sm,selections){Ext.getCmp('grid_masterCustomer').down('#deleteButton_masterCustomer').setDisabled(selections.length==0);}}});me.pagingtb_masterCustomer=helperGrid.paging({ds:store_masterCustomer_masterCustomer,title:'Customer'});return desktop.createWindow({id:me.id,title:'Customer/Member',width:900,height:450,iconCls:'icon-grid',animCollapse:false,constrainHeader:true,resizable:true,maximized:false,border:0,layout:{type:'fit'},items:[{xtype:'gridpanel',margins:'0 0 0 0',region:'center',store:store_masterCustomer_masterCustomer,id:'grid_masterCustomer',scroll:true,selModel:selModel_masterCustomer,columns:[{xtype:'gridcolumn',dataIndex:'id',text:'ID',hidden:true,hideable:false},{xtype:'gridcolumn',dataIndex:'customer_code',text:'Code',width:120},{xtype:'gridcolumn',dataIndex:'customer_name',text:'Customer/Member Name',width:180},{xtype:'gridcolumn',dataIndex:'customer_contact_person',text:'Contact Person',width:110},{xtype:'gridcolumn',dataIndex:'source_from',text:'Source',width:100},{xtype:'gridcolumn',dataIndex:'customer_status_text',text:'Status',width:90},{xtype:'gridcolumn',dataIndex:'is_active_text',text:'Active',width:90},{xtype:'gridcolumn',dataIndex:'customer_phone',text:'Phone',width:100},{xtype:'gridcolumn',dataIndex:'customer_address',text:'Alamat',width:150}],viewConfig:{stripeRows:true,forceFit:true},listeners:{itemdblclick:function(view,rec,item,index,eventObj){var getSelection=Ext.getCmp('grid_masterCustomer').getSelectionModel().selected;if(getSelection.length>0){me.formType='edit';me.edit_data=rec.data;me.createWindow(me,'add_masterCustomer');}}},bbar:me.pagingtb_masterCustomer,dockedItems:[{xtype:'toolbar',dock:'top',items:[{xtype:'textfield',name:'keywords',id:'keywords_masterCustomer',width:200,labelSeparator:'',emptyText:'Keywords: Customer/Member Name',anchor:'100%',listeners:{specialkey:function(field,e){if(e.getKey()==e.ENTER){me.search_masterCustomer();}}}},{xtype:'button',text:'Search',itemId:'btnFilterSearch_masterCustomer',tooltip:'Search',iconCls:'btn-search',handler:function(){me.search_masterCustomer();}},{xtype:'button',text:'Reset',itemId:'btnResetFilterSearch_masterCustomer',tooltip:'Reset',iconCls:'btn-reset',handler:function(){me.search_masterCustomer(true);}},'->',{text:'Add',itemId:'addButton_masterCustomer',tooltip:'Add Customer/Member',iconCls:'btn-add',handler:function(){me.formType='add';me.createWindow(me,'add_masterCustomer');}},'-',{text:'Delete',itemId:'deleteButton_masterCustomer',tooltip:'Delete Customer/Member',iconCls:'btn-delete',disabled:true,handler:function(){var getSelection=Ext.getCmp('grid_masterCustomer').getSelectionModel().selected;if(getSelection.length>0){me.delete_data=getSelection.items[0].data;me.deleteConfirm_masterCustomer();}else{ExtApp.Msg.info('Please Select Customer/Member!');}}},'-',{text:'Print',itemId:'Button_printMasterCustomer',tooltip:'Print Data',iconCls:'icon-print',handler:function(){me.print_masterCustomer();}},{text:'Download',itemId:'Button_downloadMasterCustomer',tooltip:'Download Data (Excel)',iconCls:'icon-download',handler:function(){me.download_masterCustomerExcel();}}]}]},{xtype:"component",id:'print_area_masterCustomer',autoEl:{tag:"iframe",src:url_report},border:false,hidden:true}],listeners:{boxready:function(){me.search_masterCustomer();},show:function(){}}});},add_masterCustomer:function(me){var theApp=me.app;var desktop=theApp.getDesktop();var Titletext='Add New ';if(me.formType=='edit'){Titletext='Update ';}
var store_masterStatus=theApp.getStore('master_pos.store_masterStatus',false);return desktop.createWindow({id:me.id+'_add_masterCustomer',title:Titletext,width:420,height:350,iconCls:'btn-add',animCollapse:false,constrainHeader:true,resizable:false,minimizable:false,maximizable:false,modal:true,border:0,layout:{type:'fit'},items:[{xtype:'form',id:'form_masterCustomer',border:0,bodyPadding:10,margin:'0 0 0 0',items:[{xtype:'hidden',name:'form_type_masterCustomer',value:me.formType},{xtype:'hidden',name:'id'},{xtype:'textfield',name:'customer_code',fieldLabel:'Code',anchor:'60%',},{xtype:'textfield',name:'customer_name',fieldLabel:'Cust.Name',anchor:'100%',allowBlank:false},{xtype:'textfield',name:'customer_contact_person',fieldLabel:'Contact Person',anchor:'100%',},{xtype:'textfield',name:'customer_address',fieldLabel:'Address',anchor:'100%',allowBlank:false},{xtype:'textfield',name:'customer_phone',fieldLabel:'Phone',anchor:'80%',allowBlank:false},{xtype:'textfield',name:'customer_email',fieldLabel:'Email',anchor:'100%',allowBlank:false},{xtype:'checkbox',name:'is_active',fieldLabel:'Status Active',inputValue:'1'},{xtype:'combobox',name:'customer_status',id:'customer_status_masterCustomer',fieldLabel:'Status',store:store_masterStatus,labelSeparator:':',width:200,displayField:'name',queryMode:'local',valueField:'val',typeAhead:true,minChars:1,forceSelection:true,listeners:{select:function(combo,records,eOpts){}}},{xtype:'textfield',name:'keterangan_blacklist',fieldLabel:'Ket.Blacklist',anchor:'100%',allowBlank:true}]}],buttons:[{text:'Save',formBind:true,id:'btnSave_masterCustomer',iconCls:'btn-save',handler:function(){me.save_masterCustomer();}},{text:'Cancel',iconCls:'btn-cancel',handler:function(){me.doClose(me.id+'_add_masterCustomer');}}],listeners:{show:function(){var form=Ext.getCmp('form_masterCustomer').getForm();if(me.formType=='edit'){form.setValues(me.edit_data);}else{form.reset();form.findField('is_active').setValue(1);}}}});}});