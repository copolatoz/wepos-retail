/**
 * Filename: master_pos.masterProduct.js
 * Generated 2019-04-23 at 03:12:40 AM
 */
Ext.define('ExtApp.modules.master_pos.model.model_masterProduct',{extend:'Ext.data.Model',alias:'model_masterProduct',fields:[{name:'id',type:'int'},{name:'product_code',type:'string'},{name:'product_name',type:'string'},{name:'product_name_show',type:'string'},{name:'product_chinese_name',type:'string'},{name:'product_desc',type:'string'},{name:'normal_price',type:'string'},{name:'normal_price_show',type:'string'},{name:'product_price',type:'string'},{name:'product_price_show',type:'string'},{name:'product_hpp_show',type:'string'},{name:'product_hpp',type:'string'},{name:'unit_id',type:'int'},{name:'unit_name',type:'string'},{name:'unit_code',type:'string'},{name:'category_id',type:'int'},{name:'product_category_name',type:'string'},{name:'product_category_code',type:'string'},{name:'product_group',type:'string'},{name:'product_type',type:'string'},{name:'product_image',type:'string'},{name:'product_image_show',type:'string'},{name:'product_image_src',type:'string'},{name:'has_varian',type:'int'},{name:'hide_compliment_order',type:'int'},{name:'use_tax',type:'int'},{name:'use_service',type:'int'},{name:'has_varian',type:'int'},{name:'has_varian_text',type:'string'},{name:'from_item',type:'int'},{name:'id_ref_item',type:'int'},{name:'is_active',type:'int'},{name:'is_active_text',type:'string'},{name:'supplier_id',type:'int'},{name:'is_kerjasama',type:'int'},{name:'is_kerjasama_text',type:'string'},{name:'persentase_bagi_hasil',type:'string'},{name:'total_bagi_hasil',type:'string'},{name:'total_bagi_hasil_show',type:'string'},{name:'use_stok_kode_unik',type:'int'}],proxy:{type:'ajax',url:appUrl+'master_pos/masterProduct/gridData',extraParams:{},actionMethods:{read:'POST'},reader:{type:'json',root:'data',idProperty:'id',totalProperty:'totalCount'}}});Ext.define('ExtApp.modules.master_pos.model.model_masterProductPackage',{extend:'Ext.data.Model',alias:'model_masterProductPackage',fields:[{name:'id',type:'int'},{name:'package_id',type:'int'},{name:'product_id',type:'int'},{name:'product_name',type:'string'},{name:'has_varian',type:'string'},{name:'product_varian_id',type:'string'},{name:'varian_id',type:'string'},{name:'varian_name',type:'string'},{name:'product_varian_id_item',type:'string'},{name:'varian_id_item',type:'string'},{name:'varian_name_item',type:'string'},{name:'product_desc',type:'string'},{name:'normal_price',type:'string'},{name:'normal_price_show',type:'string'},{name:'product_qty',type:'string'},{name:'product_price',type:'string'},{name:'product_price_show',type:'string'},{name:'product_hpp',type:'string'},{name:'product_hpp_show',type:'string'},{name:'total_product_price',type:'string'},{name:'total_product_price_show',type:'string'},{name:'total_product_hpp',type:'string'},{name:'total_product_hpp_show',type:'string'},{name:'category_id',type:'int'},{name:'product_category_name',type:'string'},{name:'product_type',type:'string'},{name:'product_image',type:'string'},{name:'product_image_show',type:'string'},{name:'product_image_src',type:'string'}],proxy:{type:'ajax',url:appUrl+'master_pos/masterProductPackage/gridData',extraParams:{},actionMethods:{read:'POST'},reader:{type:'json',root:'data',idProperty:'id',totalProperty:'totalCount'}}});Ext.define('ExtApp.modules.master_pos.model.model_masterProductGramasi',{extend:'Ext.data.Model',alias:'model_masterProductGramasi',fields:[{name:'id',type:'int'},{name:'product_id',type:'int'},{name:'item_id',type:'int'},{name:'item_name',type:'string'},{name:'item_category_id',type:'int'},{name:'item_category_name',type:'string'},{name:'item_price_acuan',type:'string'},{name:'item_price',type:'string'},{name:'item_qty',type:'string'},{name:'total_item_price',type:'string'},{name:'total_item_price_show',type:'string'},{name:'unit_id',type:'int'},{name:'unit_name',type:'string'}],proxy:{type:'ajax',url:appUrl+'master_pos/masterProductGramasi/gridData',extraParams:{},actionMethods:{read:'POST'},reader:{type:'json',root:'data',idProperty:'id',totalProperty:'totalCount'}}});Ext.define('ExtApp.modules.master_pos.model.model_masterProductVarian',{extend:'Ext.data.Model',alias:'model_masterProductVarian',fields:[{name:'id',type:'int'},{name:'product_id',type:'int'},{name:'varian_id',type:'int'},{name:'varian_name',type:'string'},{name:'product_price',type:'string'},{name:'normal_price',type:'string'},{name:'product_hpp',type:'string'},{name:'product_price_show',type:'string'},{name:'normal_price_show',type:'string'},{name:'product_hpp_show',type:'string'}],proxy:{type:'ajax',url:appUrl+'master_pos/masterProductVarian/gridData',extraParams:{},actionMethods:{read:'POST'},reader:{type:'json',root:'data',idProperty:'id',totalProperty:'totalCount'}}});Ext.define('ExtApp.modules.master_pos.model.model_productCategory',{extend:'Ext.data.Model',alias:'model_productCategory',fields:[{name:'id',type:'int'},{name:'parent_id',type:'int'},{name:'product_category_name',type:'string'},{name:'product_category_code',type:'string'},{name:'product_category_desc',type:'string'},{name:'product_category_code_name',type:'string'},{name:'is_active',type:'int'},{name:'is_active_text',type:'string'}],proxy:{type:'ajax',url:appUrl+'master_pos/productCategory/gridData',extraParams:{},actionMethods:{read:'POST'},reader:{type:'json',root:'data',idProperty:'id',totalProperty:'totalCount'}}});Ext.define('ExtApp.modules.master_pos.model.model_itemCategory',{extend:'Ext.data.Model',alias:'model_itemCategory',fields:[{name:'id',type:'int'},{name:'item_category_name',type:'string'},{name:'item_category_code',type:'string'},{name:'item_category_desc',type:'string'},{name:'item_category_code_name',type:'string'},{name:'is_active',type:'int'},{name:'is_active_text',type:'string'}],proxy:{type:'ajax',url:appUrl+'master_pos/itemCategory/gridData',extraParams:{},actionMethods:{read:'POST'},reader:{type:'json',root:'data',idProperty:'id',totalProperty:'totalCount'}}});Ext.define('ExtApp.modules.master_pos.model.model_masterItem',{extend:'Ext.data.Model',alias:'model_masterItem',fields:[{name:'id',type:'int'},{name:'item_code',type:'string'},{name:'item_sku',type:'string'},{name:'item_name',type:'string'},{name:'item_code_name',type:'string'},{name:'item_name_code',type:'string'},{name:'item_desc',type:'string'},{name:'item_manufacturer',type:'string'},{name:'sales_price',type:'string'},{name:'sales_price_show',type:'string'},{name:'item_price',type:'string'},{name:'item_price_show',type:'string'},{name:'item_hpp',type:'string'},{name:'item_hpp_show',type:'string'},{name:'last_in',type:'string'},{name:'last_in_show',type:'string'},{name:'total_qty_stok',type:'string'},{name:'item_type',type:'string'},{name:'item_type_name',type:'string'},{name:'item_image',type:'string'},{name:'item_image_show',type:'string'},{name:'item_image_src',type:'string'},{name:'category_id',type:'int'},{name:'item_category_name',type:'string'},{name:'item_category_code',type:'string'},{name:'subcategory_id',type:'int'},{name:'item_subcategory_name',type:'string'},{name:'item_subcategory_code',type:'string'},{name:'unit_id',type:'int'},{name:'unit_name',type:'string'},{name:'unit_code',type:'string'},{name:'supplier_id',type:'int'},{name:'supplier_name',type:'string'},{name:'is_active',type:'int'},{name:'is_active_text',type:'string'},{name:'use_for_sales',type:'int'},{name:'use_for_sales_text',type:'string'},{name:'id_ref_menu',type:'int'},{name:'sales_use_tax',type:'int'},{name:'sales_use_tax_text',type:'string'},{name:'sales_use_service',type:'int'},{name:'sales_use_service_text',type:'string'},{name:'is_kerjasama',type:'int'},{name:'is_kerjasama_text',type:'string'},{name:'persentase_bagi_hasil',type:'string'},{name:'total_bagi_hasil',type:'string'},{name:'total_bagi_hasil',type:'string'},{name:'total_bagi_hasil_show',type:'string'},{name:'use_stok_kode_unik',type:'int'},{name:'use_stok_kode_unik_text',type:'string'},{name:'min_stock',type:'string'}],proxy:{type:'ajax',url:appUrl+'master_pos/masterItem/gridData',extraParams:{},actionMethods:{read:'POST'},reader:{type:'json',root:'data',idProperty:'id',totalProperty:'totalCount'}}});Ext.define('ExtApp.modules.master_pos.model.model_varianMenu',{extend:'Ext.data.Model',alias:'model_varianMenu',fields:[{name:'id',type:'int'},{name:'varian_name',type:'string'},{name:'is_active',type:'int'},{name:'is_active_text',type:'string'}],proxy:{type:'ajax',url:appUrl+'master_pos/varianMenu/gridData',extraParams:{},actionMethods:{read:'POST'},reader:{type:'json',root:'data',idProperty:'id',totalProperty:'totalCount'}}});Ext.define('ExtApp.modules.master_pos.model.model_productVarian',{extend:'Ext.data.Model',alias:'model_productVarian',fields:[{name:'id',type:'int'},{name:'product_id',type:'string'},{name:'has_varian',type:'string'},{name:'varian_id',type:'string'},{name:'varian_name',type:'string'},{name:'product_price',type:'string'},{name:'product_price_show',type:'string'},{name:'normal_price',type:'string'},{name:'normal_price_show',type:'string'},{name:'product_hpp',type:'string'},{name:'product_hpp_show',type:'string'},{name:'is_active',type:'int'},{name:'is_active_text',type:'string'},{name:'is_promo',type:'int'},{name:'promo_id',type:'int'},{name:'promo_tipe',type:'int'},{name:'promo_percentage',type:'string'},{name:'promo_price',type:'string'},{name:'promo_price_show',type:'string'},{name:'promo_desc',type:'string'},{name:'tax_price',type:'string'},{name:'service_price',type:'string'}],proxy:{type:'ajax',url:appUrl+'master_pos/productVarian/gridData',extraParams:{},actionMethods:{read:'POST'},reader:{type:'json',root:'data',idProperty:'id',totalProperty:'totalCount'}}});Ext.define('ExtApp.modules.master_pos.model.model_masterUnit',{extend:'Ext.data.Model',alias:'model_masterUnit',fields:[{name:'id',type:'int'},{name:'unit_name',type:'string'},{name:'unit_code',type:'string'},{name:'is_active',type:'int'},{name:'is_active_text',type:'string'}],proxy:{type:'ajax',url:appUrl+'master_pos/masterUnit/gridData',extraParams:{},actionMethods:{read:'POST'},reader:{type:'json',root:'data',idProperty:'id',totalProperty:'totalCount'}}});Ext.define('ExtApp.modules.master_pos.store.store_masterProduct',{extend:'Ext.data.Store',model:'ExtApp.modules.master_pos.model.model_masterProduct',autoLoad:false,remoteSort:true});Ext.define('ExtApp.modules.master_pos.store.store_masterProductPackage',{extend:'Ext.data.Store',model:'ExtApp.modules.master_pos.model.model_masterProductPackage',autoLoad:false,remoteSort:true});Ext.define('ExtApp.modules.master_pos.store.store_masterProductGramasi',{extend:'Ext.data.Store',model:'ExtApp.modules.master_pos.model.model_masterProductGramasi',autoLoad:false,remoteSort:true});Ext.define('ExtApp.modules.master_pos.store.store_masterProductVarian',{extend:'Ext.data.Store',model:'ExtApp.modules.master_pos.model.model_masterProductVarian',autoLoad:false,remoteSort:true});Ext.define('ExtApp.modules.master_pos.store.store_productCategory',{extend:'Ext.data.Store',model:'ExtApp.modules.master_pos.model.model_productCategory',autoLoad:false,remoteSort:true});Ext.define('ExtApp.modules.master_pos.store.store_masterItem',{extend:'Ext.data.Store',model:'ExtApp.modules.master_pos.model.model_masterItem',autoLoad:false,remoteSort:true});Ext.define('ExtApp.modules.master_pos.store.store_itemCategory',{extend:'Ext.data.Store',model:'ExtApp.modules.master_pos.model.model_itemCategory',autoLoad:false,remoteSort:true});Ext.define('ExtApp.modules.master_pos.store.store_varianMenu',{extend:'Ext.data.Store',model:'ExtApp.modules.master_pos.model.model_varianMenu',autoLoad:false,remoteSort:true});Ext.define('ExtApp.modules.master_pos.store.store_productVarian',{extend:'Ext.data.Store',model:'ExtApp.modules.master_pos.model.model_productVarian',autoLoad:false,remoteSort:true});Ext.define('ExtApp.modules.master_pos.store.store_masterUnit',{extend:'Ext.data.Store',model:'ExtApp.modules.master_pos.model.model_masterUnit',autoLoad:false,remoteSort:true});Ext.define("ExtApp.modules.master_pos.view.masterProduct",{openWindow:function(me){var theApp=me.app;var desktop=theApp.getDesktop();var phpJs=me.app.getHelper('phpJs');var add_parameter='_dc='+phpJs.mktime();add_parameter+='&module=master_pos';add_parameter+='&file=masterProduct';add_parameter+='&action=print_masterProduct';var url_report='';me.store_masterProduct_masterProduct=theApp.getStore('store_masterProduct_masterProduct',false);if(me.store_masterProduct_masterProduct==false){me.store_masterProduct_masterProduct=theApp.copyStore('master_pos','store_masterProduct','store_masterProduct_masterProduct');}
me.store_masterProduct_masterProduct.proxy.extraParams.limit=25;me.store_masterProduct_masterProduct.proxy.extraParams.show_all_text=0;me.store_masterProduct_masterProduct.proxy.extraParams.show_choose_text=0;me.store_masterProduct_masterProduct.proxy.extraParams.is_dropdown=0;me.store_masterProduct_masterProduct.proxy.extraParams.product_type='';me.store_masterProduct_masterProduct.proxy.extraParams.keywords='';me.store_masterProduct_masterProduct.proxy.extraParams.is_active=0;me.store_masterProduct_masterProduct.proxy.extraParams.from_module='module';var store_masterUnit_masterProduct=theApp.getStore('store_masterUnit_masterProduct',false);if(store_masterUnit_masterProduct==false){store_masterUnit_masterProduct=theApp.copyStore('master_pos','store_masterUnit','store_masterUnit_masterProduct');}
store_masterUnit_masterProduct.proxy.extraParams.limit=99999;store_masterUnit_masterProduct.proxy.extraParams.show_all_text=0;store_masterUnit_masterProduct.proxy.extraParams.show_choose_text=1;store_masterUnit_masterProduct.proxy.extraParams.is_dropdown=1;store_masterUnit_masterProduct.proxy.extraParams.keywords='';var helperGrid=theApp.getHelper('Grid');var selModel_masterProduct=Ext.create('Ext.selection.CheckboxModel',{listeners:{selectionchange:function(sm,selections){Ext.getCmp('grid_masterProduct').down('#deleteButton_masterProduct').setDisabled(selections.length==0);}}});me.pagingtb_masterProduct=helperGrid.paging({ds:me.store_masterProduct_masterProduct,title:'Product'});var store_product_active=new Ext.data.Store({fields:['val','name'],data:[{"val":"","name":"All"},{"val":"1","name":"Active"},{"val":"0","name":"Not Active"}],autoLoad:true});return desktop.createWindow({id:me.id,title:'Master Product & Package',width:900,height:580,iconCls:'icon-grid',animCollapse:false,constrainHeader:true,resizable:true,maximized:false,border:0,layout:{type:'border'},items:[{xtype:'form',title:'Filter',width:330,region:'west',id:'form_filter_masterProduct',split:true,collapsible:true,splitterResize:false,collapseMode:'mini',animCollapse:true,scroll:false,bodyPadding:10,margin:'0 0 0 0',items:[{xtype:'textfield',name:'keywords',id:'filter_keywords_masterProduct',width:200,labelSeparator:'',emptyText:'Keywords: Name / Category',anchor:'100%',listeners:{specialkey:function(field,e){if(e.getKey()==e.ENTER){me.search_masterProduct();}}}},{xtype:'combobox',name:'is_active',fieldLabel:'Active/Not Active ',emptyText:'All',labelWidth:120,id:'filter_is_active_masterProduct',anchor:'70%',store:store_product_active,queryMode:'local',hiddenName:"val",displayField:'name',valueField:'val',typeAhead:true,minChars:1,forceSelection:true,allowBlank:false},{xtype:'container',style:'text-align:right',border:0,items:[{xtype:'button',text:'Search',scale:'medium',margin:'15 0 0 0',itemId:'btnFilterSearch_masterProduct',tooltip:'Search',iconCls:'btn-search',handler:function(){me.search_masterProduct();}},{xtype:'button',text:'Reset',scale:'medium',margin:'15 60 0 10',itemId:'btnResetFilterSearch_masterProduct',tooltip:'Reset',iconCls:'btn-reset',handler:function(){me.search_masterProduct(true);}}]}]},{xtype:'gridpanel',margins:'0 0 0 0',region:'center',store:me.store_masterProduct_masterProduct,id:'grid_masterProduct',scroll:true,selModel:selModel_masterProduct,columns:[{xtype:'gridcolumn',dataIndex:'id',text:'ID',hideable:false,width:60},{xtype:'gridcolumn',dataIndex:'product_code',text:'Kode',width:150},{xtype:'gridcolumn',dataIndex:'product_name',text:'Nama',width:200},{xtype:'gridcolumn',dataIndex:'has_varian_text',text:'Varian',width:100},{xtype:'gridcolumn',dataIndex:'product_type',text:'Type',width:80},{xtype:'gridcolumn',dataIndex:'product_category_name',text:'Category',width:150},{xtype:'gridcolumn',dataIndex:'normal_price_show',text:'Normal Price',width:150},{xtype:'gridcolumn',dataIndex:'product_price_show',text:'Current Price',width:150},{xtype:'gridcolumn',dataIndex:'product_hpp_show',text:'HPP',width:100},{xtype:'gridcolumn',dataIndex:'product_image_show',text:'Image',width:120},{xtype:'gridcolumn',dataIndex:'product_desc',text:'Description',width:200},{xtype:'gridcolumn',dataIndex:'is_active_text',text:'Status Active',width:100}],viewConfig:{stripeRows:true,forceFit:true},listeners:{itemdblclick:function(view,rec,item,index,eventObj){var getSelection=Ext.getCmp('grid_masterProduct').getSelectionModel().selected;if(getSelection.length>0){me.formType='edit';me.edit_data=rec.data;me.createWindow(me,'add_masterProduct');}}},bbar:me.pagingtb_masterProduct,dockedItems:[{xtype:'toolbar',dock:'top',items:[{text:'Filter',itemId:'filterButton_masterProduct',tooltip:'Filter Product',iconCls:'btn-search',listeners:{click:function(){Ext.getCmp('form_filter_masterProduct').toggleCollapse();}}},'->',{text:'Download',itemId:'Button_downloadMasterProduct',tooltip:'Download format Product',iconCls:'icon-download',handler:function(){me.download_masterProductExcel(true);}},'-',{text:'Upload',itemId:'Button_uploadMasterProduct',tooltip:'Upload format Product',iconCls:'btn-add',handler:function(){me.formType='add';me.createWindow(me,'add_uploadMasterProduct');}},'-',{text:'Add',itemId:'addButton_masterProduct',tooltip:'Add Product',iconCls:'btn-add',handler:function(){me.formType='add';me.createWindow(me,'add_masterProduct');}},'-',{text:'Delete',itemId:'deleteButton_masterProduct',tooltip:'Delete Product',iconCls:'btn-delete',disabled:true,handler:function(){var getSelection=Ext.getCmp('grid_masterProduct').getSelectionModel().selected;if(getSelection.length>0){me.delete_data=getSelection.items[0].data;me.deleteConfirm_masterProduct();}else{ExtApp.Msg.info('Please Select Product!');}}},'-',{text:'Refresh',itemId:'refreshButton_masterProduct',tooltip:'Refresh Product',iconCls:'btn-refresh',handler:function(){me.search_masterProduct();}}]}]},{xtype:"component",id:'print_area_masterProduct',autoEl:{tag:"iframe",src:url_report},border:false,hidden:true}],listeners:{boxready:function(){store_masterUnit_masterProduct.load();Ext.getCmp('form_filter_masterProduct').toggleCollapse();me.search_masterProduct();},show:function(){}}});},add_masterProduct:function(me){var theApp=me.app;var desktop=theApp.getDesktop();var Titletext='Add New ';if(me.formType=='edit'){Titletext='Update ';}
var store_product_type=new Ext.data.Store({fields:['val','name'],data:[{"val":"item","name":"Item"},{"val":"package","name":"Package"}],autoLoad:true});var helperGrid=theApp.getHelper('Grid');var selModel_masterProductPackage=Ext.create('Ext.selection.CheckboxModel',{listeners:{selectionchange:function(sm,selections){Ext.getCmp('grid_masterProductPackage').down('#deleteButton_masterProductPackage').setDisabled(selections.length==0);}}});me.store_masterProductPackage_masterProduct=theApp.getStore('store_masterProductPackage_masterProduct',false);if(me.store_masterProductPackage_masterProduct==false){me.store_masterProductPackage_masterProduct=theApp.copyStore('master_pos','store_masterProductPackage','store_masterProductPackage_masterProduct');}
me.store_masterProductPackage_masterProduct.proxy.extraParams.limit=9999;me.store_masterProductPackage_masterProduct.proxy.extraParams.show_all_text=0;me.store_masterProductPackage_masterProduct.proxy.extraParams.show_choose_text=0;me.store_masterProductPackage_masterProduct.proxy.extraParams.is_dropdown=0;me.store_masterProductPackage_masterProduct.proxy.extraParams.keywords='';var store_productCategory_masterProduct=theApp.getStore('store_productCategory_masterProduct',false);if(store_productCategory_masterProduct==false){store_productCategory_masterProduct=theApp.copyStore('master_pos','store_productCategory','store_productCategory_masterProduct');}
store_productCategory_masterProduct.proxy.extraParams.limit=9999999;store_productCategory_masterProduct.proxy.extraParams.show_all_text=0;store_productCategory_masterProduct.proxy.extraParams.show_choose_text=1;store_productCategory_masterProduct.proxy.extraParams.is_dropdown=1;store_productCategory_masterProduct.proxy.extraParams.keywords='';var selModel_masterProductGramasi=Ext.create('Ext.selection.CheckboxModel',{listeners:{selectionchange:function(sm,selections){Ext.getCmp('grid_masterProductGramasi').down('#deleteButton_masterProductGramasi').setDisabled(selections.length==0);}}});me.store_masterProductGramasi_masterProduct=theApp.getStore('store_masterProductGramasi_masterProduct',false);if(me.store_masterProductGramasi_masterProduct==false){me.store_masterProductGramasi_masterProduct=theApp.copyStore('master_pos','store_masterProductGramasi','store_masterProductGramasi_masterProduct');}
me.store_masterProductGramasi_masterProduct.proxy.extraParams.limit=9999;me.store_masterProductGramasi_masterProduct.proxy.extraParams.varian_id=0;me.store_masterProductGramasi_masterProduct.proxy.extraParams.show_all_text=0;me.store_masterProductGramasi_masterProduct.proxy.extraParams.show_choose_text=0;me.store_masterProductGramasi_masterProduct.proxy.extraParams.is_dropdown=0;me.store_masterProductGramasi_masterProduct.proxy.extraParams.keywords='';var selModel_varianMenu=Ext.create('Ext.selection.CheckboxModel',{listeners:{selectionchange:function(sm,selections){Ext.getCmp('grid_masterProductVarian').down('#deleteButton_masterProductVarian').setDisabled(selections.length==0);}}});me.store_masterProductVarian_masterProduct=theApp.getStore('store_masterProductVarian_masterProduct',false);if(me.store_masterProductVarian_masterProduct==false){me.store_masterProductVarian_masterProduct=theApp.copyStore('master_pos','store_masterProductVarian','store_masterProductVarian_masterProduct');}
me.store_masterProductVarian_masterProduct.proxy.extraParams.limit=9999;me.store_masterProductVarian_masterProduct.proxy.extraParams.show_all_text=0;me.store_masterProductVarian_masterProduct.proxy.extraParams.show_choose_text=1;me.store_masterProductVarian_masterProduct.proxy.extraParams.is_dropdown=1;me.store_masterProductVarian_masterProduct.proxy.extraParams.keywords='';var store_masterUnit_masterProduct=theApp.getStore('store_masterUnit_masterProduct',false);if(store_masterUnit_masterProduct==false){store_masterUnit_masterProduct=theApp.copyStore('master_pos','store_masterUnit','store_masterUnit_masterProduct');}
store_masterUnit_masterProduct.proxy.extraParams.limit=9999;store_masterUnit_masterProduct.proxy.extraParams.show_all_text=0;store_masterUnit_masterProduct.proxy.extraParams.show_choose_text=1;store_masterUnit_masterProduct.proxy.extraParams.is_dropdown=1;store_masterUnit_masterProduct.proxy.extraParams.keywords='';return desktop.createWindow({id:me.id+'_add_masterProduct',title:Titletext,width:750,height:450,iconCls:'btn-add',animCollapse:false,constrainHeader:true,resizable:false,minimizable:false,maximizable:false,modal:true,border:0,layout:{type:'fit'},items:{xtype:'tabpanel',minHeight:490,activeTab:0,border:false,defaults:{bodyPadding:'10 10 10 10',layout:'fit'},items:[{title:'Product Info',layout:'fit',items:[{xtype:'form',id:'form_masterProduct',border:0,layout:{type:'border'},items:[{xtype:'panel',flex:1,region:'center',layout:{type:'auto'},border:0,bodyPadding:10,margin:'0 5 0 0',defaults:{margin:'5 0 0 0',width:365},items:[{xtype:'hidden',name:'form_type_masterProduct',value:me.formType},{xtype:'hidden',name:'id'},{xtype:'hidden',name:'tipe'},{xtype:'hidden',name:'product_image'},{xtype:'hidden',name:'old_product_type'},{xtype:'hidden',name:'category_id'},{xtype:'hidden',name:'product_category_code'},{xtype:'hidden',name:'unit_id'},{xtype:'hidden',name:'from_item'},{xtype:'hidden',name:'id_ref_item'},{xtype:'panel',border:0,id:'product_code_masterProduct',layout:{type:'column'},margin:'0 0 5 0',items:[{xtype:'textfield',name:'product_code',fieldLabel:'Kode',width:270,labelWidth:100,emptyText:'- AUTO -',margin:'0 5 0 0',},{xtype:'button',text:'Update',id:'btnUpdateProductCode_masterProduct',tooltip:'Update Kode',iconCls:'btn-tick',handler:function(){me.updateProductCode_masterProduct();}}]},{xtype:'textfield',name:'product_name',fieldLabel:'Name',anchor:'100%',allowBlank:false},{xtype:'radiogroup',fieldLabel:'Group',id:'product_group_masterProduct',columns:3,vertical:true,hidden:true,items:[{boxLabel:'Food',id:'product_group_Food_masterProduct',name:'product_group',inputValue:'food',checked:true,width:60},{boxLabel:'Beverage',id:'product_group_Beverage_masterProduct',name:'product_group',inputValue:'beverage',width:80},{boxLabel:'Other',id:'product_group_Other_masterProduct',name:'product_group',inputValue:'other',width:80}]},{xtype:'combobox',name:'product_type',fieldLabel:'Type',anchor:'100%',store:store_product_type,queryMode:'local',hiddenName:"val",displayField:'name',valueField:'val',typeAhead:true,minChars:1,forceSelection:true,allowBlank:false},{xtype:'combobox',name:'product_category_code_name',fieldLabel:'Category',emptyText:'-Select-',anchor:'100%',labelWidth:100,store:store_productCategory_masterProduct,displayField:'product_category_code_name',valueField:'id',queryMode:'local',allowBlank:false,listeners:{select:function(combo,records,eOpts){var form2=Ext.getCmp('form_masterProduct').getForm();form2.findField('category_id').setValue(records[0].data.id);form2.findField('product_category_code_name').setValue(records[0].data.product_category_code_name);form2.findField('product_category_code').setValue(records[0].data.product_category_code);}}},{xtype:'combobox',name:'unit_code',fieldLabel:'Unit',emptyText:'-Select-',anchor:'100%',labelWidth:100,store:store_masterUnit_masterProduct,displayField:'unit_code',valueField:'id',queryMode:'local',allowBlank:false,listeners:{select:function(combo,records,eOpts){var form2=Ext.getCmp('form_masterProduct').getForm();form2.findField('unit_id').setValue(records[0].data.id);form2.findField('unit_code').setValue(records[0].data.unit_code);}}},{xtype:'numberfield',name:'normal_price',fieldLabel:'Normal Price',width:250,minValue:0,allowDecimals:true,allowBlank:false,hideTrigger:true,keyNavEnabled:false,mouseWheelEnabled:false},{xtype:'numberfield',name:'product_price',fieldLabel:'Current Price',width:250,minValue:0,allowDecimals:true,allowBlank:false,hideTrigger:true,keyNavEnabled:false,mouseWheelEnabled:false},{xtype:'numberfield',name:'product_hpp',fieldLabel:'HPP',width:250,minValue:0,allowDecimals:true,allowBlank:false,hideTrigger:true,keyNavEnabled:false,mouseWheelEnabled:false},{xtype:'checkbox',name:'is_active',fieldLabel:'Status Active',inputValue:'1',margin:'0 0 10 0'},{xtype:'checkbox',name:'use_tax',fieldLabel:'Use Tax',inputValue:'1',margin:'0 0 0 0'},{xtype:'checkbox',name:'use_service',fieldLabel:'Use Service',inputValue:'1',hidden:true,margin:'0 0 10 0'},{xtype:'checkbox',name:'has_varian',fieldLabel:'Varian Product',inputValue:'1',margin:'0 0 0 0',hidden:true}]},{xtype:'panel',flex:0.8,region:'east',layout:{type:'auto'},border:0,bodyPadding:10,items:[{xtype:'displayfield',value:'Product Description'},{xtype:'htmleditor',name:'product_desc',anchor:'100%',height:100,enableColors:false,enableAlignments:false,enableFont:false,enableFontSize:false,enableFormat:true,enableLinks:false,enableLists:false,enableSourceEdit:false,margin:'0 0 10 0'},{xtype:'displayfield',value:'Product Image'},{xtype:'filefield',name:'upload_image',emptyText:'Upload Image, Size Image min 640 (pixel)',msgTarget:'side',width:300,buttonText:'',buttonConfig:{iconCls:'btn-upload'}},{xtype:'image',id:'product_image_src',name:'product_image_src',autoEl:'div',margin:'0 0 5 0'}]}]}]},{title:'Varian',id:'product_varian_list',bodyPadding:'0 0 0 0',border:0,layout:'border',items:[{xtype:'gridpanel',margins:'0 0 0 0',border:0,width:740,height:335,store:me.store_masterProductVarian_masterProduct,id:'grid_masterProductVarian',scroll:true,selModel:selModel_varianMenu,columns:[{xtype:'gridcolumn',dataIndex:'id',text:'ID',hidden:true,hideable:false},{xtype:'gridcolumn',dataIndex:'varian_id',hidden:true,hideable:false},{xtype:'gridcolumn',dataIndex:'varian_name',text:'Varian Name',width:150},{xtype:'gridcolumn',dataIndex:'product_hpp_show',text:'HPP',width:120},{xtype:'gridcolumn',dataIndex:'normal_price_show',text:'Normal.Price',width:120},{xtype:'gridcolumn',dataIndex:'product_price_show',text:'Varian.Price',width:120}],viewConfig:{stripeRows:true,forceFit:true},listeners:{itemdblclick:function(view,rec,item,index,eventObj){var getSelection=Ext.getCmp('grid_masterProductVarian').getSelectionModel().selected;if(getSelection.length>0){me.formType_listVarian='edit';me.edit_data_listVarian=rec.data;me.createWindow(me,'add_masterProductVarian');}}},bbar:helperGrid.paging({ds:me.store_masterProductPackage_masterProduct,title:'Varian'}),dockedItems:[{xtype:'toolbar',dock:'top',items:['->',{text:'Add',itemId:'addButton_masterProductVarian',tooltip:'Add Item Varian',iconCls:'btn-add',handler:function(){me.formType_listVarian='add';me.createWindow(me,'add_masterProductVarian');}},'-',{text:'Delete',itemId:'deleteButton_masterProductVarian',tooltip:'Delete Item Varian',iconCls:'btn-delete',disabled:true,handler:function(){var getSelection=Ext.getCmp('grid_masterProductVarian').getSelectionModel().selected;if(getSelection.length>0){me.delete_data_listVarian=getSelection.items[0].data;me.deleteConfirm_masterProductVarian();}else{ExtApp.Msg.info('Please Select Varian!');}}},'-',{text:'Refresh',itemId:'refreshButton_masterProductVarian',tooltip:'Refresh Item Varian',iconCls:'btn-refresh',handler:function(){me.showhide_productVarian(2);}}]}]}]},{title:'Link Item',id:'product_gramasi_list',bodyPadding:'0 0 0 0',border:0,layout:'border',items:[{xtype:'gridpanel',margins:'0 0 0 0',border:0,width:740,height:335,store:me.store_masterProductGramasi_masterProduct,id:'grid_masterProductGramasi',scroll:true,selModel:selModel_masterProductGramasi,columns:[{xtype:'gridcolumn',dataIndex:'id',text:'ID',hidden:true,hideable:false},{xtype:'gridcolumn',dataIndex:'item_id',hidden:true,hideable:false},{xtype:'gridcolumn',dataIndex:'item_name',text:'Item Name',width:150},{xtype:'gridcolumn',dataIndex:'item_category_name',text:'Category',width:150},{xtype:'gridcolumn',dataIndex:'item_qty',text:'Qty Item',width:80},{xtype:'gridcolumn',dataIndex:'item_price',text:'HPP',width:80},{xtype:'gridcolumn',dataIndex:'total_item_price',text:'Total HPP',width:120},{xtype:'gridcolumn',dataIndex:'unit_name',text:'Unit Name',width:120}],viewConfig:{stripeRows:true,forceFit:true},listeners:{itemdblclick:function(view,rec,item,index,eventObj){var getSelection=Ext.getCmp('grid_masterProductGramasi').getSelectionModel().selected;if(getSelection.length>0){me.formType_listGramasi='edit';me.edit_data_listGramasi=rec.data;me.createWindow(me,'add_masterProductGramasi');}}},bbar:helperGrid.paging({ds:me.store_masterProductGramasi_masterProduct,title:'Link Item'}),dockedItems:[{xtype:'toolbar',dock:'top',items:[{xtype:'combobox',name:'varian_id',id:'varian_id_masterProductGramasi',fieldLabel:'Varian',width:'200',labelWidth:50,store:me.store_masterProductVarian_masterProduct,queryMode:'local',hiddenName:"id",displayField:'varian_name',valueField:'id',typeAhead:true,minChars:1,forceSelection:true,listConfig:{emptyText:'Tidak ada data',minWidth:200,getInnerTpl:function(){return'{varian_name}';}},pageSize:0,listeners:{select:function(combo,records,eOpts){me.store_masterProductGramasi_masterProduct.proxy.extraParams.product_varian_id=records[0].data.id;me.store_masterProductGramasi_masterProduct.proxy.extraParams.varian_id=records[0].data.varian_id;Ext.getCmp('default_product_varian_id_masterProductGramasi').setValue(records[0].data.id);Ext.getCmp('default_varian_id_masterProductGramasi').setValue(records[0].data.varian_id);Ext.getCmp('grid_masterProductGramasi').store.load();}}},{xtype:'hidden',name:'default_product_varian_id_masterProductGramasi',id:'default_product_varian_id_masterProductGramasi',},{xtype:'hidden',name:'default_varian_id_masterProductGramasi',id:'default_varian_id_masterProductGramasi',},'->',{text:'Add',itemId:'addButton_masterProductGramasi',tooltip:'Add Link Item',iconCls:'btn-add',handler:function(){me.formType_listGramasi='add';me.createWindow(me,'add_masterProductGramasi');}},'-',{text:'Delete',itemId:'deleteButton_masterProductGramasi',tooltip:'Delete Link Item',iconCls:'btn-delete',disabled:true,handler:function(){var getSelection=Ext.getCmp('grid_masterProductGramasi').getSelectionModel().selected;if(getSelection.length>0){me.delete_data_listGramasi=getSelection.items[0].data;me.deleteConfirm_masterProductGramasi();}else{ExtApp.Msg.info('Please Select Item!');}}},'-',{text:'Refresh',itemId:'refreshButton_masterProductGramasi',tooltip:'Refresh Item Gramasi',iconCls:'btn-refresh',handler:function(){Ext.getCmp('grid_masterProductGramasi').store.load();}}]}]}]},{title:'Package Item',id:'product_package_list',bodyPadding:'0 0 0 0',border:0,layout:'border',items:[{xtype:'gridpanel',margins:'0 0 0 0',border:0,width:740,height:335,store:me.store_masterProductPackage_masterProduct,id:'grid_masterProductPackage',scroll:true,selModel:selModel_masterProductPackage,columns:[{xtype:'gridcolumn',dataIndex:'id',text:'ID',hidden:true,hideable:false},{xtype:'gridcolumn',dataIndex:'product_id',hidden:true,hideable:false},{xtype:'gridcolumn',dataIndex:'product_name',text:'Name',width:150},{xtype:'gridcolumn',dataIndex:'varian_name',text:'Varian',width:80},{xtype:'gridcolumn',dataIndex:'normal_price_show',text:'Normal.Price',width:110},{xtype:'gridcolumn',dataIndex:'product_qty',text:'Qty',width:60},{xtype:'gridcolumn',dataIndex:'product_price_show',text:'Package.Price',width:110},{xtype:'gridcolumn',dataIndex:'product_hpp_show',text:'HPP',width:80},{xtype:'gridcolumn',dataIndex:'total_product_price_show',text:'Total Price',width:110},{xtype:'gridcolumn',dataIndex:'total_product_hpp_show',text:'Total HPP',width:110},{xtype:'gridcolumn',dataIndex:'product_category_name',text:'Category',width:150},{xtype:'gridcolumn',dataIndex:'product_desc',text:'Description',width:200}],viewConfig:{stripeRows:true,forceFit:true},listeners:{itemdblclick:function(view,rec,item,index,eventObj){var getSelection=Ext.getCmp('grid_masterProductPackage').getSelectionModel().selected;if(getSelection.length>0){me.formType_listPackage='edit';me.edit_data_listPackage=rec.data;me.createWindow(me,'add_masterProductPackage');}}},bbar:helperGrid.paging({ds:me.store_masterProductPackage_masterProduct,title:'List Package'}),dockedItems:[{xtype:'toolbar',dock:'top',items:[{xtype:'combobox',name:'varian_id',id:'varian_id_masterProductPackage',fieldLabel:'Varian',width:'200',labelWidth:50,store:me.store_masterProductVarian_masterProduct,queryMode:'local',hiddenName:"id",displayField:'varian_name',valueField:'id',typeAhead:true,minChars:1,forceSelection:true,listConfig:{emptyText:'Tidak ada data',minWidth:200,getInnerTpl:function(){return'{varian_name}';}},pageSize:0,listeners:{select:function(combo,records,eOpts){me.store_masterProductPackage_masterProduct.proxy.extraParams.product_varian_id=records[0].data.id;me.store_masterProductPackage_masterProduct.proxy.extraParams.varian_id=records[0].data.varian_id;Ext.getCmp('default_product_varian_id_masterProductPackage').setValue(records[0].data.id);Ext.getCmp('default_varian_id_masterProductPackage').setValue(records[0].data.varian_id);Ext.getCmp('grid_masterProductPackage').store.load();}}},{xtype:'hidden',name:'default_product_varian_id_masterProductPackage',id:'default_product_varian_id_masterProductPackage',},{xtype:'hidden',name:'default_varian_id_masterProductPackage',id:'default_varian_id_masterProductPackage',},'->',{text:'Add',itemId:'addButton_masterProductPackage',tooltip:'Add Item Product Package',iconCls:'btn-add',handler:function(){me.formType_listPackage='add';me.createWindow(me,'add_masterProductPackage');}},'-',{text:'Delete',itemId:'deleteButton_masterProductPackage',tooltip:'Delete Item Product Package',iconCls:'btn-delete',disabled:true,handler:function(){var getSelection=Ext.getCmp('grid_masterProductPackage').getSelectionModel().selected;if(getSelection.length>0){me.delete_data_listPackage=getSelection.items[0].data;me.deleteConfirm_masterProductPackage();}else{ExtApp.Msg.info('Please Select Product Package!');}}},'-',{text:'Refresh',itemId:'refreshButton_masterProductPackage',tooltip:'Refresh List Product Package',iconCls:'btn-refresh',handler:function(){Ext.getCmp('grid_masterProductPackage').store.load();}}]}]}]}]},buttons:[{xtype:'displayfield',id:'info_masterProduct',value:'',fieldStyle:'font-weight:bold; color:blue;'},'->',{text:'Save',formBind:true,id:'btnSave_masterProduct',iconCls:'btn-save',handler:function(){me.saveConfirm_masterProduct();}},{text:'Cancel',iconCls:'btn-cancel',handler:function(){me.doClose(me.id+'_add_masterProduct');}}],listeners:{show:function(){var form=Ext.getCmp('form_masterProduct').getForm();Ext.getCmp('default_product_varian_id_masterProductGramasi').setValue(0);Ext.getCmp('default_varian_id_masterProductGramasi').setValue(0);Ext.getCmp('default_product_varian_id_masterProductPackage').setValue(0);Ext.getCmp('default_varian_id_masterProductPackage').setValue(0);me.store_masterProductPackage_masterProduct.proxy.extraParams.product_varian_id=0;me.store_masterProductPackage_masterProduct.proxy.extraParams.varian_id=0;me.store_masterProductGramasi_masterProduct.proxy.extraParams.product_varian_id=0;me.store_masterProductGramasi_masterProduct.proxy.extraParams.varian_id=0;Ext.getCmp('product_varian_list').setDisabled(false);form.findField('product_type').show();form.findField('product_code').setDisabled(false);form.findField('unit_code').setDisabled(false);form.findField('product_hpp').setDisabled(false);form.findField('product_category_code_name').setDisabled(false);if(me.formType=='edit'){form.setValues(me.edit_data);Ext.getCmp('product_image_src').setSrc(me.edit_data.product_image_src);form.findField('old_product_type').setValue(me.edit_data.product_type);form.findField('product_group').setValue(me.edit_data.product_group);Ext.getCmp('grid_masterProductVarian').store.proxy.extraParams.product_id=me.edit_data.id;me.showhide_productVarian(0);if(me.edit_data.product_type=='item'){Ext.getCmp('product_package_list').setDisabled(true);Ext.getCmp('product_gramasi_list').setDisabled(false);Ext.getCmp('grid_masterProductPackage').store.loadData([]);Ext.getCmp('grid_masterProductGramasi').store.proxy.extraParams.product_id=me.edit_data.id;Ext.getCmp('grid_masterProductGramasi').store.load();}else{Ext.getCmp('product_package_list').setDisabled(false);Ext.getCmp('product_gramasi_list').setDisabled(true);Ext.getCmp('grid_masterProductPackage').store.proxy.extraParams.package_id=me.edit_data.id;Ext.getCmp('grid_masterProductPackage').store.load();Ext.getCmp('grid_masterProductGramasi').store.loadData([]);}
Ext.getCmp('btnUpdateProductCode_masterProduct').show();if(me.edit_data.from_item==1&&me.edit_data.id_ref_item>0){Ext.getCmp('info_masterProduct').setValue('*Product ini terhubung dengan Data Item: '+me.edit_data.product_code);Ext.getCmp('product_varian_list').setDisabled(true);Ext.getCmp('product_gramasi_list').setDisabled(true);Ext.getCmp('btnUpdateProductCode_masterProduct').hide();form.findField('product_type').hide();form.findField('product_code').setDisabled(true);form.findField('unit_code').setDisabled(true);form.findField('product_hpp').setDisabled(true);form.findField('product_category_code_name').setDisabled(true);}}else{form.reset();form.findField('is_active').setValue(1);form.findField('product_type').setValue('item');Ext.getCmp('product_package_list').setDisabled(true);Ext.getCmp('product_gramasi_list').setDisabled(true);Ext.getCmp('product_varian_list').setDisabled(true);Ext.getCmp('btnUpdateProductCode_masterProduct').hide();}
store_productCategory_masterProduct.load({callback:function(){if(me.formType=='edit'){form.findField('product_category_code_name').select(me.edit_data.category_id);}}});store_masterUnit_masterProduct.load({callback:function(){if(me.formType=='edit'){form.findField('unit_code').select(me.edit_data.unit_id);}}});form.findField('tipe').setValue('retail');}}});},add_masterProductVarian:function(me){var theApp=me.app;var desktop=theApp.getDesktop();var Titletext='Add Varian Product ';if(me.formType_listVarian=='edit'){Titletext='Update Varian Product: ';}else{me.edit_data_listVarian=[];}
var store_varianMenu_masterProduct=theApp.getStore('store_varianMenu_masterProduct',false);if(store_varianMenu_masterProduct==false){store_varianMenu_masterProduct=theApp.copyStore('master_pos','store_varianMenu','store_varianMenu_masterProduct');}
store_varianMenu_masterProduct.proxy.extraParams.limit=9999;store_varianMenu_masterProduct.proxy.extraParams.show_all_text=0;store_varianMenu_masterProduct.proxy.extraParams.show_choose_text=1;store_varianMenu_masterProduct.proxy.extraParams.is_dropdown=1;store_varianMenu_masterProduct.proxy.extraParams.keywords='';return desktop.createWindow({id:me.id+'_add_masterProductVarian',title:Titletext,width:450,height:215,iconCls:'btn-add',animCollapse:false,constrainHeader:true,resizable:false,minimizable:false,maximizable:false,modal:true,border:0,layout:{type:'fit'},items:[{xtype:'form',id:'form_masterProductVarian',border:0,bodyPadding:10,margin:'0 0 0 0',items:[{xtype:'hidden',name:'form_type_masterProductVarian',value:me.formType_listVarian},{xtype:'hidden',name:'product_id'},{xtype:'hidden',name:'id'},{xtype:'combobox',name:'varian_id',id:'varian_id_masterProductVarian',fieldLabel:'Varian',anchor:'100%',labelWidth:120,store:store_varianMenu_masterProduct,queryMode:'local',hiddenName:"id",displayField:'varian_name',valueField:'id',typeAhead:true,minChars:1,forceSelection:true,allowBlank:false,listConfig:{emptyText:'Tidak ada data',minWidth:250,getInnerTpl:function(){return'{varian_name}';}},pageSize:0,listeners:{select:function(combo,records,eOpts){var form=Ext.getCmp('form_masterProductVarian').getForm();form.findField('varian_id').setValue(records[0].data.id);form.findField('product_price').setValue(me.edit_data.product_price);form.findField('normal_price').setValue(me.edit_data.normal_price);form.findField('product_hpp').setValue(me.edit_data.product_hpp);}}},{xtype:'textfield',name:'product_hpp',fieldLabel:'HPP',width:250,labelWidth:120,allowBlank:false},{xtype:'textfield',name:'normal_price',fieldLabel:'Hrg.Normal',width:250,labelWidth:120,allowBlank:false},{xtype:'textfield',name:'product_price',fieldLabel:'Hrg.Jual',width:250,labelWidth:120,allowBlank:false}]}],buttons:[{text:'Save',formBind:true,id:'btnSave_masterProductVarian',iconCls:'btn-save',handler:function(){me.save_masterProductVarian();}},{text:'Cancel',iconCls:'btn-cancel',handler:function(){me.doClose(me.id+'_add_masterProductVarian');}}],listeners:{show:function(){var form=Ext.getCmp('form_masterProductVarian').getForm();var myMask=new Ext.LoadMask(Ext.getCmp('form_masterProductVarian'),{msg:"Loading..."});myMask.show();if(me.formType_listVarian=='edit'){form.setValues(me.edit_data_listVarian);}else{form.reset();}
form.findField('product_id').setValue(me.edit_data.id);store_varianMenu_masterProduct.load({params:{show_choose_text:1},callback:function(records,operation,success){var varian_id=0;if(me.formType_listVarian=='edit'){varian_id=me.edit_data_listVarian.varian_id;form.findField('varian_id').setValue(me.edit_data_listVarian.varian_id);form.findField('product_price').setValue(me.edit_data_listVarian.product_price);form.findField('normal_price').setValue(me.edit_data_listVarian.normal_price);form.findField('product_hpp').setValue(me.edit_data_listVarian.product_hpp);form.findField('id').setValue(me.edit_data_listVarian.id);}
myMask.hide();Ext.getCmp('varian_id_masterProductVarian').select(varian_id);}});}}});},add_masterProductGramasi:function(me){var theApp=me.app;var desktop=theApp.getDesktop();var Titletext='Add Gramasi Item ';if(me.formType_listGramasi=='edit'){Titletext='Update Gramasi Item: ';}else{me.edit_data_listGramasi=[];}
var phpJs=theApp.getHelper('phpJs');var store_ComboboxMasterItem_masterProduct=theApp.getStore('store_ComboboxMasterItem_masterProduct',false);if(store_ComboboxMasterItem_masterProduct==false){store_ComboboxMasterItem_masterProduct=theApp.copyStore('master_pos','store_masterItem','store_ComboboxMasterItem_masterProduct');}
store_ComboboxMasterItem_masterProduct.proxy.extraParams.limit=9999;store_ComboboxMasterItem_masterProduct.proxy.extraParams.show_all_text=0;store_ComboboxMasterItem_masterProduct.proxy.extraParams.show_choose_text=1;store_ComboboxMasterItem_masterProduct.proxy.extraParams.is_dropdown=1;store_ComboboxMasterItem_masterProduct.proxy.extraParams.keywords='';return desktop.createWindow({id:me.id+'_add_masterProductGramasi',title:Titletext,width:450,height:265,iconCls:'btn-add',animCollapse:false,constrainHeader:true,resizable:false,minimizable:false,maximizable:false,modal:true,border:0,layout:{type:'fit'},items:[{xtype:'form',id:'form_masterProductGramasi',border:0,bodyPadding:10,margin:'0 0 0 0',items:[{xtype:'hidden',name:'form_type_masterProductGramasi',value:me.formType_listGramasi},{xtype:'hidden',name:'product_id'},{xtype:'hidden',name:'item_price'},{xtype:'hidden',name:'product_varian_id'},{xtype:'hidden',name:'varian_id'},{xtype:'hidden',name:'has_varian'},{xtype:'hidden',name:'id'},{xtype:'combobox',name:'item_id',id:'item_id_masterProductGramasi',fieldLabel:'Item',anchor:'100%',labelWidth:120,store:store_ComboboxMasterItem_masterProduct,queryMode:'local',hiddenName:"id",displayField:'item_name',valueField:'id',typeAhead:true,minChars:1,forceSelection:true,allowBlank:false,listConfig:{emptyText:'Tidak ada data',minWidth:250,getInnerTpl:function(){return'{item_name}';}},pageSize:0,listeners:{select:function(combo,records,eOpts){var form=Ext.getCmp('form_masterProductGramasi').getForm();form.findField('item_id').setValue(records[0].data.id);form.findField('unit_name').setValue(records[0].data.unit_name);form.findField('item_category_name').setValue(records[0].data.item_category_name);form.findField('item_qty').setValue(1);form.findField('item_price').setValue(records[0].data.item_price);form.findField('item_price_acuan').setValue(records[0].data.item_price_show);var get_total_product_price=1*records[0].data.item_price;form.findField('total_item_price').setValue(phpJs.priceFormat(get_total_product_price));}}},{xtype:'textfield',name:'item_qty',fieldLabel:'Qty Item',anchor:'100%',labelWidth:120,allowBlank:false,listeners:{blur:function(field,val){var form=Ext.getCmp('form_masterProductGramasi').getForm();var get_item_qty=parseFloat(form.findField('item_qty').getValue());var get_item_price=parseFloat(form.findField('item_price').getValue());var get_total_product_price=get_item_qty*get_item_price;form.findField('total_item_price').setValue(phpJs.priceFormat(get_total_product_price));}}},{xtype:'displayfield',name:'item_price_acuan',fieldLabel:'Harga Acuan/Unit',anchor:'100%',labelWidth:120},{xtype:'displayfield',name:'total_item_price',fieldLabel:'Total HPP',anchor:'100%',labelWidth:120},{xtype:'displayfield',name:'item_category_name',fieldLabel:'Category',anchor:'100%',labelWidth:120,allowBlank:false},{xtype:'displayfield',name:'unit_name',fieldLabel:'Unit',anchor:'100%',labelWidth:120,allowBlank:false}]}],buttons:[{text:'Save',formBind:true,id:'btnSave_masterProductGramasi',iconCls:'btn-save',handler:function(){me.save_masterProductGramasi();}},{text:'Cancel',iconCls:'btn-cancel',handler:function(){me.doClose(me.id+'_add_masterProductGramasi');}}],listeners:{show:function(){var form=Ext.getCmp('form_masterProductGramasi').getForm();var myMask=new Ext.LoadMask(Ext.getCmp('form_masterProductGramasi'),{msg:"Loading..."});myMask.show();if(me.formType_listGramasi=='edit'){form.setValues(me.edit_data_listGramasi);}else{form.reset();}
var default_product_varian_id_masterProductGramasi=Ext.getCmp("default_product_varian_id_masterProductGramasi").getValue();var default_varian_id_masterProductGramasi=Ext.getCmp("default_varian_id_masterProductGramasi").getValue();form.findField('product_varian_id').setValue(default_product_varian_id_masterProductGramasi);form.findField('varian_id').setValue(default_varian_id_masterProductGramasi);form.findField('product_id').setValue(me.edit_data.id);store_ComboboxMasterItem_masterProduct.load({params:{show_choose_text:1},callback:function(records,operation,success){var item_id=0;if(me.formType_listGramasi=='edit'){item_id=me.edit_data_listGramasi.item_id;form.findField('item_id').setValue(me.edit_data_listGramasi.item_id);form.findField('item_price').setValue(me.edit_data_listGramasi.item_price);form.findField('item_qty').setValue(me.edit_data_listGramasi.item_qty);form.findField('item_price_acuan').setValue(me.edit_data_listGramasi.item_price_acuan);form.findField('item_category_name').setValue(me.edit_data_listGramasi.item_category_name);form.findField('unit_name').setValue(me.edit_data_listGramasi.unit_name);form.findField('id').setValue(me.edit_data_listGramasi.id);var get_total_product_price=me.edit_data_listGramasi.item_qty*me.edit_data_listGramasi.item_price;form.findField('total_item_price').setValue(phpJs.priceFormat(get_total_product_price));}
myMask.hide();Ext.getCmp('item_id_masterProductGramasi').select(item_id);}});me.showhide_productVarian(1,"Gramasi");}}});},add_masterProductPackage:function(me){var theApp=me.app;var desktop=theApp.getDesktop();var Titletext='Add Package Item ';if(me.formType_listPackage=='edit'){Titletext='Update Package Item: ';}
var phpJs=theApp.getHelper('phpJs');me.store_selectProduct_masterProductPackage=theApp.getStore('store_selectProduct_masterProductPackage',false);if(me.store_selectProduct_masterProductPackage==false){me.store_selectProduct_masterProductPackage=theApp.copyStore('master_pos','store_masterProduct','store_selectProduct_masterProductPackage');}
me.store_selectProduct_masterProductPackage.proxy.extraParams.limit=9999999;me.store_selectProduct_masterProductPackage.proxy.extraParams.show_all_text=0;me.store_selectProduct_masterProductPackage.proxy.extraParams.show_choose_text=1;me.store_selectProduct_masterProductPackage.proxy.extraParams.is_dropdown=1;me.store_selectProduct_masterProductPackage.proxy.extraParams.product_type='item';me.store_selectProduct_masterProductPackage.proxy.extraParams.keywords='';me.store_selectProduct_masterProductPackage.proxy.extraParams.is_active=1;me.store_selectProduct_masterProductPackage.proxy.extraParams.from_module='';me.store_productVarian_masterProductPackage=theApp.getStore('store_productVarian_masterProductPackage',false);if(me.store_productVarian_masterProductPackage==false){me.store_productVarian_masterProductPackage=theApp.copyStore('master_pos','store_masterProductVarian','store_productVarian_masterProductPackage');}
me.store_productVarian_masterProductPackage.proxy.extraParams.limit=9999999;me.store_productVarian_masterProductPackage.proxy.extraParams.is_dropdown=1;me.store_productVarian_masterProductPackage.proxy.extraParams.show_all_text=0;me.store_productVarian_masterProductPackage.proxy.extraParams.show_choose_text=1;me.store_productVarian_masterProductPackage.proxy.extraParams.is_dropdown=1;me.store_productVarian_masterProductPackage.proxy.extraParams.keywords='';return desktop.createWindow({id:me.id+'_add_masterProductPackage',title:Titletext,width:450,height:330,iconCls:'btn-add',animCollapse:false,constrainHeader:true,resizable:false,minimizable:false,maximizable:false,modal:true,border:0,layout:{type:'fit'},items:[{xtype:'form',id:'form_masterProductPackage',border:0,bodyPadding:10,margin:'0 0 0 0',items:[{xtype:'hidden',name:'form_type_masterProductPackage',value:me.formType_listPackage},{xtype:'hidden',name:'id'},{xtype:'hidden',name:'package_id'},{xtype:'hidden',name:'normal_price'},{xtype:'hidden',name:'has_varian'},{xtype:'hidden',name:'product_varian_id'},{xtype:'hidden',name:'varian_id'},{xtype:'hidden',name:'product_varian_id_item'},{xtype:'hidden',name:'varian_id_item'},{xtype:'hidden',name:'varian_name'},{xtype:'hidden',name:'product_id'},{xtype:'hidden',name:'product_hpp'},{xtype:'combobox',name:'product_name',id:'product_name_masterProductPackage',fieldLabel:'Product',emptyText:'Pilih Product',anchor:'100%',store:me.store_selectProduct_masterProductPackage,hiddenName:"id",displayField:'product_name',valueField:'id',queryMode:'local',anyMatch:true,allowBlank:false,listConfig:{emptyText:'Tidak ada data',minWidth:250,getInnerTpl:function(){return'{product_name}';}},pageSize:0,listeners:{select:function(combo,records,eOpts){var form=Ext.getCmp('form_masterProductPackage').getForm();form.findField('product_id').setValue(records[0].data.id);form.findField('normal_price').setValue(records[0].data.product_price);form.findField('product_price').setValue(records[0].data.product_price);form.findField('product_hpp').setValue(records[0].data.product_hpp);form.findField('product_hpp_show').setValue(records[0].data.product_hpp_show);form.findField('varian_id_item').setValue(0);form.findField('has_varian').setValue(records[0].data.has_varian);form.findField('normal_price_show').setValue(records[0].data.product_price_show);if(records[0].data.has_varian==1){form.findField('varian_name_item_masterProductPackage').show();me.store_productVarian_masterProductPackage.proxy.extraParams.product_id=records[0].data.id;me.store_productVarian_masterProductPackage.load({callback:function(){if(!me.edit_data.product_varian_id){}else{form.findField('varian_name_item_masterProductPackage').setValue(me.edit_data.product_varian_id);}}});}else{form.findField('varian_name_item_masterProductPackage').hide();}
var get_product_qty=parseFloat(form.findField('product_qty').getValue());var get_product_price=parseFloat(form.findField('product_price').getValue());var get_product_hpp=parseFloat(form.findField('product_hpp').getValue());var get_total_product_price=get_product_qty*get_product_price;var get_total_product_hpp=get_product_qty*get_product_hpp;form.findField('total_product_price').setValue(phpJs.priceFormat(get_total_product_price));form.findField('total_product_hpp').setValue(phpJs.priceFormat(get_total_product_hpp));}}},{xtype:'combobox',name:'varian_name_item',id:'varian_name_item_masterProductPackage',fieldLabel:'Varian',emptyText:'Pilih Varian',store:me.store_productVarian_masterProductPackage,hidden:true,labelSeparator:':',anchor:'100%',displayField:'varian_name',valueField:'id',queryMode:'local',anyMatch:true,allowBlank:true,listeners:{select:function(combo,records,eOpts){var form=Ext.getCmp('form_masterProductPackage').getForm();form.findField('normal_price').setValue(records[0].data.product_price);form.findField('product_price').setValue(records[0].data.product_price);form.findField('product_hpp').setValue(records[0].data.product_hpp);form.findField('product_varian_id_item').setValue(records[0].data.id);form.findField('varian_id_item').setValue(records[0].data.varian_id);form.findField('varian_name').setValue(records[0].data.varian_name);form.findField('normal_price_show').setValue(records[0].data.product_price_show);var get_product_qty=parseFloat(form.findField('product_qty').getValue());var get_product_price=parseFloat(form.findField('product_price').getValue());var get_product_hpp=parseFloat(form.findField('product_hpp').getValue());var product_hpp_show=parseFloat(form.findField('product_hpp').getValue());var get_total_product_price=get_product_qty*get_product_price;var get_total_product_hpp=get_product_qty*get_product_hpp;form.findField('total_product_price').setValue(phpJs.priceFormat(get_total_product_price));form.findField('total_product_hpp').setValue(phpJs.priceFormat(get_total_product_hpp));form.findField('product_hpp_show').setValue(phpJs.priceFormat(product_hpp_show));}}},{xtype:'textfield',name:'product_qty',fieldLabel:'Product Qty',anchor:'100%',allowBlank:false,listeners:{blur:function(field,val){var form=Ext.getCmp('form_masterProductPackage').getForm();var get_product_qty=parseFloat(form.findField('product_qty').getValue());var get_product_price=parseFloat(form.findField('product_price').getValue());var get_product_hpp=parseFloat(form.findField('product_hpp').getValue());var get_total_product_price=get_product_qty*get_product_price;var get_total_product_hpp=get_product_qty*get_product_hpp;form.findField('total_product_price').setValue(phpJs.priceFormat(get_total_product_price));form.findField('total_product_hpp').setValue(phpJs.priceFormat(get_total_product_hpp));}}},{xtype:'displayfield',name:'normal_price_show',fieldLabel:'Normal Price',anchor:'100%',},{xtype:'textfield',name:'product_price',fieldLabel:'Package Price',anchor:'100%',allowBlank:false,listeners:{blur:function(field,val){var form=Ext.getCmp('form_masterProductPackage').getForm();var get_product_qty=parseFloat(form.findField('product_qty').getValue());var get_product_price=parseFloat(form.findField('product_price').getValue());var get_product_hpp=parseFloat(form.findField('product_hpp').getValue());var get_total_product_price=get_product_qty*get_product_price;var get_total_product_hpp=get_product_qty*get_product_hpp;form.findField('total_product_price').setValue(phpJs.priceFormat(get_total_product_price));form.findField('total_product_hpp').setValue(phpJs.priceFormat(get_total_product_hpp));}}},{xtype:'displayfield',name:'product_hpp_show',fieldLabel:'HPP',anchor:'100%',},{xtype:'displayfield',name:'total_product_price',fieldLabel:'Total Price',anchor:'100%',},{xtype:'displayfield',name:'total_product_hpp',fieldLabel:'Total HPP',anchor:'100%',}]}],buttons:[{text:'Save',formBind:true,id:'btnSave_masterProductPackage',iconCls:'btn-save',handler:function(){me.save_masterProductPackage();}},{text:'Cancel',iconCls:'btn-cancel',handler:function(){me.doClose(me.id+'_add_masterProductPackage');}}],listeners:{show:function(){var form=Ext.getCmp('form_masterProductPackage').getForm();var myMask=new Ext.LoadMask(Ext.getCmp('form_masterProductPackage'),{msg:"Loading..."});myMask.show();if(me.formType_listPackage=='edit'){form.setValues(me.edit_data_listPackage);}else{form.reset();form.findField('product_qty').setValue(1);}
var default_product_varian_id_masterProductPackage=Ext.getCmp("default_product_varian_id_masterProductPackage").getValue();var default_varian_id_masterProductPackage=Ext.getCmp("default_varian_id_masterProductPackage").getValue();form.findField('product_varian_id').setValue(default_product_varian_id_masterProductPackage);form.findField('varian_id').setValue(default_varian_id_masterProductPackage);form.findField('package_id').setValue(me.edit_data.id);me.store_selectProduct_masterProductPackage.load({params:{package_id:me.edit_data.id,show_choose_text:1},callback:function(records,operation,success){if(me.formType_listPackage=='edit'){product_id=me.edit_data_listPackage.product_id;Ext.getCmp('product_name_masterProductPackage').select(me.edit_data_listPackage.product_name);Ext.getCmp('varian_name_item_masterProductPackage').select(me.edit_data_listPackage.varian_name_item);if(me.edit_data_listPackage.has_varian==1){form.findField('varian_name_item').show();me.store_productVarian_masterProductPackage.proxy.extraParams.product_id=me.edit_data_listPackage.product_id;me.store_productVarian_masterProductPackage.load({callback:function(){form.findField('varian_name_item').setValue(me.edit_data_listPackage.varian_name);}});}else{form.findField('varian_name_item').hide();}}else{Ext.getCmp('product_name_masterProductPackage').select('');Ext.getCmp('varian_name_item_masterProductPackage').select('');}
myMask.hide();}});me.showhide_productVarian(1,"Package");}}});},add_uploadMasterProduct:function(me){var theApp=me.app;var desktop=theApp.getDesktop();var Titletext='Upload Product ';if(me.formType=='edit'){Titletext='Upload Product: ';}
var helperGrid=theApp.getHelper('Grid');var phpJs=theApp.getHelper('phpJs');return desktop.createWindow({id:me.id+'_add_uploadMasterProduct',title:Titletext,width:370,height:170,iconCls:'btn-add',animCollapse:false,constrainHeader:true,resizable:true,minimizable:false,maximizable:false,modal:true,border:0,layout:{type:'fit'},items:[{xtype:'form',id:'form_uploadMasterProduct',border:0,bodyPadding:10,margin:'0 0 0 0',labelWidth:100,items:[{xtype:'filefield',name:'upload_file',emptyText:'Excel (.xls)',fieldLabel:'File Product ',margin:'5 0 15 0',width:300,buttonText:'',buttonConfig:{iconCls:'btn-upload'}}]}],buttons:[{text:'Save',formBind:true,id:'btnSave_uploadMasterProduct',iconCls:'btn-save',handler:function(){me.save_uploadMasterProduct();}},{text:'Cancel',iconCls:'btn-cancel',handler:function(){me.doClose(me.id+'_add_uploadMasterProduct');}}],listeners:{show:function(){}}});}});