/**
 * Filename: sync_backup.backupTrx.js
 * Generated 2019-04-19 at 09:55:52 AM
 */
Ext.define('ExtApp.modules.sync_backup.model.model_backupTrx',{extend:'Ext.data.Model',alias:'model_backupTrx',fields:[{name:'id',type:'int'},{name:'no',type:'string'},{name:'list_info',type:'string'},{name:'store_info',type:'string'}],proxy:{type:'ajax',url:appUrl+'sync_backup/backupTrx/storeInfo',extraParams:{},actionMethods:{read:'POST'},reader:{type:'json',root:'data',idProperty:'id',totalProperty:'totalCount'}}});Ext.define('ExtApp.modules.sync_backup.model.model_backupTrxDetail',{extend:'Ext.data.Model',alias:'model_backupTrxDetail',fields:[{name:'id',type:'int'},{name:'client_id',type:'string'},{name:'client_code',type:'string'},{name:'client_name',type:'string'},{name:'client_email',type:'string'},{name:'backup_data',type:'string'},{name:'backup_data_text',type:'string'},{name:'total_data_lokal',type:'string'},{name:'total_data_server',type:'string'},{name:'last_id_lokal',type:'string'},{name:'last_id_server',type:'string'},{name:'last_update',type:'string'},{name:'backup_status',type:'string'},{name:'backup_status_text',type:'string'},{name:'last_id_on_backup',type:'string'},{name:'total_data_on_backup',type:'string'}],proxy:{type:'ajax',url:appUrl+'sync_backup/backupTrx/backupDetail',extraParams:{},actionMethods:{read:'POST'},reader:{type:'json',root:'data',idProperty:'id',totalProperty:'totalCount'}}});Ext.define('ExtApp.modules.sync_backup.model.model_backupTrxLog',{extend:'Ext.data.Model',alias:'model_backupTrxLog',fields:[{name:'id',type:'int'},{name:'client_id',type:'int'},{name:'backup_date',type:'string'},{name:'backup_data',type:'string'},{name:'backup_data_text',type:'string'},{name:'total_data',type:'string'},{name:'last_id',type:'string'},{name:'auto_manual',type:'string'},{name:'auto_manual_text',type:'string'},{name:'backup_type',type:'string'},{name:'backup_type_text',type:'string'},],proxy:{type:'ajax',url:appUrl+'sync_backup/backupTrx/backupTrxLog',extraParams:{},actionMethods:{read:'POST'},reader:{type:'json',root:'data',idProperty:'id',totalProperty:'totalCount'}}});Ext.define('ExtApp.modules.sync_backup.store.store_backupTrx',{extend:'Ext.data.Store',model:'ExtApp.modules.sync_backup.model.model_backupTrx',autoLoad:false,remoteSort:true});Ext.define('ExtApp.modules.sync_backup.store.store_backupTrxDetail',{extend:'Ext.data.Store',model:'ExtApp.modules.sync_backup.model.model_backupTrxDetail',autoLoad:false,remoteSort:true});Ext.define('ExtApp.modules.sync_backup.store.store_backupTrxLog',{extend:'Ext.data.Store',model:'ExtApp.modules.sync_backup.model.model_backupTrxLog',autoLoad:false,remoteSort:true});Ext.define("ExtApp.modules.sync_backup.view.backupTrx",{openWindow:function(me){var theApp=me.app;var desktop=theApp.getDesktop();var store_backupTrx_grid=theApp.getStore('store_backupTrx_grid',false);if(store_backupTrx_grid==false){store_backupTrx_grid=theApp.copyStore('sync_backup','store_backupTrx','store_backupTrx_grid');}
store_backupTrx_grid.proxy.extraParams.limit=999999;store_backupTrx_grid.proxy.extraParams.client_id=0;var store_backupTrxDetail_grid=theApp.getStore('store_backupTrxDetail_grid',false);if(store_backupTrxDetail_grid==false){store_backupTrxDetail_grid=theApp.copyStore('sync_backup','store_backupTrxDetail','store_backupTrxDetail_grid');}
store_backupTrxDetail_grid.proxy.extraParams.limit=999999;store_backupTrxDetail_grid.proxy.extraParams.client_id=0;var helperGrid=theApp.getHelper('Grid');var phpJs=theApp.getHelper('phpJs');var selModel_backupTrxDetail=Ext.create('Ext.selection.CheckboxModel',{listeners:{selectionchange:function(sm,selections){Ext.getCmp('generateButton_backupTrx').setDisabled(selections.length==0);}}});return desktop.createWindow({id:me.id,title:'Backup Data Transaksi',width:1000,height:550,iconCls:'icon-backup',animCollapse:false,constrainHeader:true,resizable:true,maximized:false,border:false,border:0,layout:{type:'fit'},items:[{xtype:'panel',border:0,layout:{type:'border'},items:[{xtype:'gridpanel',flex:1,margins:'0 5 0 0',region:'west',store:store_backupTrx_grid,id:'grid_backupTrx',scroll:true,columns:[{xtype:'gridcolumn',dataIndex:'id',text:'no',hidden:true,hideable:false},{xtype:'gridcolumn',dataIndex:'list_info',text:' Merchant Info',width:110,sortable:false},{xtype:'gridcolumn',dataIndex:'store_info',text:'',width:250,sortable:false}],viewConfig:{stripeRows:true,forceFit:true}},{title:'Backup Transaksi Detail',xtype:'gridpanel',flex:2,margins:'0 0 0 0',region:'center',store:store_backupTrxDetail_grid,id:'grid_backupTrxDetail',scroll:true,selModel:selModel_backupTrxDetail,columns:[{xtype:'gridcolumn',dataIndex:'backup_data_text',text:'BACKUP TRANSAKSI',width:170,sortable:false},{text:'TOTAL DATA',columns:[{xtype:'gridcolumn',dataIndex:'total_data_lokal',text:'LOKAL',width:70},{xtype:'gridcolumn',dataIndex:'total_data_server',text:'BACKUP',width:80},]},{text:'LAST ID',columns:[{xtype:'gridcolumn',dataIndex:'last_id_lokal',text:'LOKAL',width:70},{xtype:'gridcolumn',dataIndex:'last_id_server',text:'BACKUP',width:80},]},{xtype:'gridcolumn',dataIndex:'last_update',text:'LAST UPDATE',width:120,sortable:false},{xtype:'gridcolumn',dataIndex:'backup_status_text',text:'STATUS',width:120,sortable:false},],viewConfig:{stripeRows:true,forceFit:true},listeners:{itemdblclick:function(view,rec,item,index,eventObj){}},}],dockedItems:[{xtype:'toolbar',dock:'top',items:[{xtype:'hidden',name:'client_id_backupTrx',id:'client_id_backupTrx'},{xtype:'hidden',name:'client_code_backupTrx',id:'client_code_backupTrx'},{xtype:'hidden',name:'client_name_backupTrx',id:'client_name_backupTrx'},{xtype:'hidden',name:'client_email_backupTrx',id:'client_email_backupTrx'},{xtype:'button',text:'Koneksikan Merchant / Refresh',id:'searchButton_backupTrx',tooltip:'Search',iconCls:'btn-search',handler:function(){me.search_backupTrx();}},'->',{text:'Log',id:'logButton_backupTrx',tooltip:'Log Data',iconCls:'btn-lock',listeners:{click:function(){me.client_id_backupTrx=Ext.getCmp('client_id_backupTrx').getValue();me.client_code_backupTrx=Ext.getCmp('client_code_backupTrx').getValue();me.client_name_backupTrx=Ext.getCmp('client_name_backupTrx').getValue();me.client_email_backupTrx=Ext.getCmp('client_email_backupTrx').getValue();me.createWindow(me,'show_backupTrxLog');}}}]},{xtype:'toolbar',dock:'bottom',items:[{xtype:'displayfield',id:'displayProgres_backupTrx',name:'displayProgres_backupTrx',labelWidth:0,width:550,value:'Pilih Data dan Klik Tombol Backup Transaksi'},'->',{text:'Backup Transaksi',id:'generateButton_backupTrx',tooltip:'Backup Transaksi',disabled:true,iconCls:'icon-backup',listeners:{click:function(){var getSelection=Ext.getCmp('grid_backupTrxDetail').getSelectionModel().selected;if(getSelection.length>0){me.generateStop_backupTrx=false;me.generateConfirm_backupTrx();}else{ExtApp.Msg.info('Silahkan Pilih Backup Transaksi!');}}}},{text:'Stop Backup',id:'stopButton_backupTrx',tooltip:'Stop Backup Transaksi',hidden:true,iconCls:'btn-stop',listeners:{click:function(){me.generateStop_backupTrx=true;Ext.getCmp('generateButton_backupTrx').show();Ext.getCmp('stopButton_backupTrx').hide();}}}]}]}],listeners:{boxready:function(){},show:function(){me.reset_backupTrxDetail();Ext.getCmp('client_name_backupTrx').setValue('');}}});},show_backupTrxLog:function(me){var client_id_backupTrx=Ext.getCmp('client_id_backupTrx').getValue();var client_name_backupTrx=Ext.getCmp('client_name_backupTrx').getValue();var client_code_backupTrx=Ext.getCmp('client_code_backupTrx').getValue();var client_email_backupTrx=Ext.getCmp('client_email_backupTrx').getValue();if(!client_code_backupTrx){alert('Store/Merchant tidak dikenali!');return false;}
var theApp=me.app;var desktop=theApp.getDesktop();var Titletext='Log Backup: '+client_name_backupTrx;var store_backupTrx_backupTrxLog=theApp.getStore('store_backupTrx_backupTrxLog',false);if(store_backupTrx_backupTrxLog==false){store_backupTrx_backupTrxLog=theApp.copyStore('sync_backup','store_backupTrxLog','store_backupTrx_backupTrxLog');}
store_backupTrx_backupTrxLog.proxy.extraParams.limit=25;store_backupTrx_backupTrxLog.proxy.extraParams.client_id=client_id_backupTrx;store_backupTrx_backupTrxLog.proxy.extraParams.client_code=client_code_backupTrx;store_backupTrx_backupTrxLog.proxy.extraParams.client_name=client_name_backupTrx;store_backupTrx_backupTrxLog.proxy.extraParams.client_email=client_email_backupTrx;var helperGrid=theApp.getHelper('Grid');var phpJs=theApp.getHelper('phpJs');return desktop.createWindow({id:me.id+'_show_backupTrxLog',title:Titletext,width:700,height:500,iconCls:'btn-add',animCollapse:false,constrainHeader:true,resizable:false,minimizable:false,maximizable:false,modal:true,border:0,layout:{type:'fit'},items:[{xtype:'gridpanel',store:store_backupTrx_backupTrxLog,id:'grid_backupTrxLog',scroll:true,columns:[{xtype:'gridcolumn',dataIndex:'id',text:'no',hidden:true,hideable:false},{xtype:'gridcolumn',dataIndex:'backup_date',text:'Backup Time',width:150,sortable:false},{xtype:'gridcolumn',dataIndex:'backup_data_text',text:'Backup Transaksi',width:120,sortable:false},{xtype:'gridcolumn',dataIndex:'total_data',text:'Total',width:80,sortable:false},{xtype:'gridcolumn',dataIndex:'last_id',text:'Last ID',width:80,sortable:false},{xtype:'gridcolumn',dataIndex:'auto_manual_text',text:'Backup By',width:120,sortable:false},{xtype:'gridcolumn',dataIndex:'backup_type_text',text:'Backup From',width:120,sortable:false}],viewConfig:{stripeRows:true,forceFit:true},bbar:helperGrid.paging({ds:store_backupTrx_backupTrxLog,title:'Backup Log'})}],listeners:{show:function(){store_backupTrx_backupTrxLog.load();}}});}});